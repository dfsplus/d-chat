!function(e){function t(t){for(var r,a,u=t[0],c=t[1],s=t[2],l=0,d=[];l<u.length;l++)a=u[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(f&&f(t);d.length;)d.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,u=1;u<n.length;u++){var c=n[u];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={3:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var f=c;i.push([315,1]),n()}({118:function(e,t,n){(function(t){var r=n(579);function o(e,n){var o=JSON.stringify(n),i=r.utf8ToBuffer(o),a=t.crypto.getRandomValues(new Uint8Array(16));return t.crypto.subtle.encrypt({name:"AES-GCM",iv:a},e,i).then((function(e){var t=new Uint8Array(e),n=r.bufferToBase64(a);return{data:r.bufferToBase64(t),iv:n}}))}function i(e,t){var n=r.base64ToBuffer(t.data),o=r.base64ToBuffer(t.iv);return crypto.subtle.decrypt({name:"AES-GCM",iv:o},e,n).then((function(e){var t=new Uint8Array(e),n=r.bufferToUtf8(t);return JSON.parse(n)})).catch((function(e){throw new Error("Incorrect password")}))}function a(e,n){var o=r.utf8ToBuffer(e),i=r.base64ToBuffer(n);return t.crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]).then((function(e){return t.crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e4,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}))}function u(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,n=new Uint8Array(e);t.crypto.getRandomValues(n);var r=btoa(String.fromCharCode.apply(null,n));return r}e.exports={encrypt:function(e,t){var n=c();return a(e,n).then((function(e){return o(e,t)})).then((function(e){return e.salt=n,JSON.stringify(e)}))},decrypt:function(e,t){var n=JSON.parse(t),r=n.salt;return a(e,r).then((function(e){return i(e,n)}))},keyFromPassword:a,encryptWithKey:o,decryptWithKey:i,serializeBufferForStorage:function(e){for(var t="0x",n=e.length||e.byteLength,r=0;r<n;r++)t+=u(e[r]);return t},serializeBufferFromStorage:function(e){for(var t="0x"===e.slice(0,2)?e.slice(2):e,n=new Uint8Array(t.length/2),r=0;r<t.length;r+=2){var o=t.substr(r,2);n[r/2]=parseInt(o,16)}return n},generateSalt:c}}).call(this,n(13))},119:function(e,t,n){var r,o,i;o=[],void 0===(i="function"===typeof(r=function(){"use strict";return function(e,t,n){t=t||"",n=n||512;for(var r=atob(e),o=[],i=0;i<r.length;i+=n){for(var a=r.slice(i,i+n),u=new Array(a.length),c=0;c<a.length;c++)u[c]=a.charCodeAt(c);var s=new Uint8Array(u);o.push(s)}return new Blob(o,{type:t})}})?r.apply(t,o):r)||(e.exports=i)},120:function(e,t,n){(function(){function n(e){var t=null;if("string"!==typeof e)return t;var n=e.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);return n&&n.length&&(t=n[1]),t}e.exports&&(t=e.exports=n),t.base64MimeType=n}).call(this)},123:function(e,t,n){"use strict";var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r}var i=Object.keys,a=Array.isArray,u="undefined"!==typeof self?self:"undefined"!==typeof window?window:global;function c(e,t){return"object"!==typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"===typeof Promise||u.Promise||(u.Promise=Promise);var s=Object.getPrototypeOf,f={}.hasOwnProperty;function l(e,t){return f.call(e,t)}function d(e,t){"function"===typeof t&&(t=t(s(e))),i(t).forEach((function(n){h(e,n,t[n])}))}var p=Object.defineProperty;function h(e,t,n,r){p(e,t,c(n&&l(n,"get")&&"function"===typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function y(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var v=Object.getOwnPropertyDescriptor;var b=[].slice;function m(e,t,n){return b.call(e,t,n)}function g(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function _(e){u.setImmediate?setImmediate(e):setTimeout(e,0)}function O(e,t){return e.reduce((function(e,n,r){var o=t(n,r);return o&&(e[o[0]]=o[1]),e}),{})}function E(e,t){if(l(e,t))return e[t];if(!t)return e;if("string"!==typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=E(e,t[r]);n.push(i)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return void 0===u?void 0:E(u,t.substr(a+1))}}function S(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!==typeof t&&"length"in t){w("string"!==typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)S(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var u=t.substr(0,i),c=t.substr(i+1);if(""===c)void 0===n?a(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var s=e[u];s||(s=e[u]={}),S(s,c,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function A(e){var t={};for(var n in e)l(e,n)&&(t[n]=e[n]);return t}var k=[].concat;function x(e){return k.apply([],e)}var j="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(x([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return u[e]})),T=j.map((function(e){return u[e]})),P=O(j,(function(e){return[e,!0]}));function I(e){if(!e||"object"!==typeof e)return e;var t;if(a(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(I(e[n]))}else if(T.indexOf(e.constructor)>=0)t=e;else for(var o in t=e.constructor?Object.create(e.constructor.prototype):{},e)l(e,o)&&(t[o]=I(e[o]));return t}var C={}.toString;function D(e){return C.call(e).slice(8,-1)}var R=function e(t,n){return"Array"===n?""+t.map((function(t){return e(t,D(t))})):"ArrayBuffer"===n?""+new Uint8Array(t):"Date"===n?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function N(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((function(o){if(l(t,o)){var i=e[o],a=t[o];if("object"===typeof i&&"object"===typeof a&&i&&a){var u=D(i),c=D(a);u===c?P[u]?R(i,u)!==R(a,c)&&(n[r+o]=t[o]):N(i,a,n,r+o+"."):n[r+o]=t[o]}else i!==a&&(n[r+o]=t[o])}else n[r+o]=void 0})),i(t).forEach((function(o){l(e,o)||(n[r+o]=t[o])})),n}var M="undefined"!==typeof Symbol&&Symbol.iterator,B=M?function(e){var t;return null!=e&&(t=e[M])&&t.apply(e)}:function(){return null},K={};function F(e){var t,n,r,o;if(1===arguments.length){if(a(e))return e.slice();if(this===K&&"string"===typeof e)return[e];if(o=B(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"===typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var U="undefined"!==typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},L="undefined"!==typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function q(e,t){L=e,V=t}var V=function(){return!0},z=!new Error("").stack;function G(){if(z)try{throw new Error}catch(e){return e}return new Error}function H(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(V).map((function(e){return"\n"+e})).join("")):""}var W=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Y=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(W),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function X(e,t){this._e=G(),this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Q(e,t,n,r){this._e=G(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=$(e,t)}function Z(e,t){this._e=G(),this.name="BulkError",this.failures=t,this.message=$(e,t)}y(X).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+H(this._e,2))}},toString:function(){return this.name+": "+this.message}}),y(Q).from(X),y(Z).from(X);var ee=Y.reduce((function(e,t){return e[t]=t+"Error",e}),{}),te=X,ne=Y.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=G(),this.name=n,e?"string"===typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"===typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=J[t]||n,this.inner=null)}return y(r).from(te),e[t]=r,e}),{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var re=W.reduce((function(e,t){return e[t+"Error"]=ne[t],e}),{});var oe=Y.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ne[t]),e}),{});function ie(){}function ae(e){return e}function ue(e,t){return null==e||e===ae?t:function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function se(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r),o&&(this.onerror=this.onerror?ce(o,this.onerror):o),void 0!==i?i:n}}function fe(e,t){return e===ie?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ce(r,this.onerror):r)}}function le(e,t){return e===ie?t:function(n){var r=e.apply(this,arguments);c(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ce(o,this.onsuccess):o),i&&(this.onerror=this.onerror?ce(i,this.onerror):i),void 0===r?void 0===a?void 0:a:c(r,a)}}function de(e,t){return e===ie?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function pe(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);if(n&&"function"===typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then((function(){return t.apply(r,i)}))}return t.apply(this,arguments)}}oe.ModifyError=Q,oe.DexieError=X,oe.BulkError=Z;var he={},ye="undefined"===typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"===typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),ve=ye[0],be=ye[1],me=ye[2],ge=be&&be.then,we=ve&&ve.constructor,_e=!!me,Oe=!1,Ee=me?function(){me.then(Ge)}:u.setImmediate?setImmediate.bind(null,Ge):u.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Ge(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Ge,0)},Se=function(e,t){De.push([e,t]),ke&&(Ee(),ke=!1)},Ae=!0,ke=!0,xe=[],je=[],Te=null,Pe=ae,Ie={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ht,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{ht(e[0],e[1])}catch(t){}}))}},Ce=Ie,De=[],Re=0,Ne=[];function Me(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ie,this._lib=!1;var t=this._PSD=Ce;if(L&&(this._stackHolder=G(),this._prev=null,this._numPrev=0),"function"!==typeof e){if(e!==he)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ue(this,this._value))}this._state=null,this._value=null,++t.ref,Fe(this,e)}var Be={get:function(){var e=Ce,t=tt;function n(n,r){var o=this,i=!e.global&&(e!==Ce||t!==tt);i&&it();var a=new Me((function(t,a){qe(o,new Ke(dt(n,e,i),dt(r,e,i),t,a,e))}));return L&&ze(a,this),a}return n.prototype=he,n},set:function(e){h(this,"then",e&&e.prototype===he?Be:{get:function(){return e},set:Be.set})}};function Ke(e,t,n,r,o){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function Fe(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&He();t&&"function"===typeof t.then?Fe(e,(function(e,n){t instanceof Me?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Le(e)),n&&We()}}),Ue.bind(null,e))}catch(n){Ue(e,n)}}function Ue(e,t){if(je.push(t),null===e._state){var n=e._lib&&He();t=Pe(t),e._state=!1,e._value=t,L&&null!==t&&"object"===typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}((function(){var n=function e(t,n){var r;return v(t,n)||(r=s(t))&&e(r,n)}(t,"stack");t._promise=e,h(t,"stack",{get:function(){return Oe?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){xe.some((function(t){return t._value===e._value}))||xe.push(e)}(e),Le(e),n&&We()}}function Le(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)qe(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===Re&&(++Re,Se((function(){0===--Re&&Ye()}),[]))}function qe(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Re,Se(Ve,[n,e,t])}else e._listeners.push(t)}function Ve(e,t,n){try{Te=t;var r,o=t._value;t._state?r=e(o):(je.length&&(je=[]),r=e(o),-1===je.indexOf(o)&&function(e){var t=xe.length;for(;t;)if(xe[--t]._value===e._value)return void xe.splice(t,1)}(t)),n.resolve(r)}catch(i){n.reject(i)}finally{Te=null,0===--Re&&Ye(),--n.psd.ref||n.psd.finalize()}}function ze(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Ge(){He()&&We()}function He(){var e=Ae;return Ae=!1,ke=!1,e}function We(){var e,t,n;do{for(;De.length>0;)for(e=De,De=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(De.length>0);Ae=!0,ke=!0}function Ye(){var e=xe;xe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Ne.slice(0),n=t.length;n;)t[--n]()}function Je(e){return new Me(he,!1,e)}function Xe(e,t){var n=Ce;return function(){var r=He(),o=Ce;try{return st(n,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{st(o,!1),r&&We()}}}d(Me.prototype,{then:Be,_then:function(e,t){qe(this,new Ke(null,null,e,t,Ce))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"===typeof t?this.then(null,(function(e){return e instanceof t?n(e):Je(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Je(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Je(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{Oe=!0;var e=function e(t,n,r){if(n.length===r)return n;var o="";if(!1===t._state){var i,a,u=t._value;null!=u?(i=u.name||"Error",a=u.message||u,o=H(u,0)):(i=u,a=""),n.push(i+(a?": "+a:"")+o)}L&&((o=H(t._stackHolder,2))&&-1===n.indexOf(o)&&n.push(o),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Oe=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Me((function(r,o){var i=setTimeout((function(){return o(new ne.Timeout(t))}),e);n.then(r,o).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!==typeof Symbol&&Symbol.toStringTag&&h(Me.prototype,Symbol.toStringTag,"Dexie.Promise"),Ie.env=ft(),d(Me,{all:function(){var e=F.apply(null,arguments).map(at);return new Me((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(o,i){return Me.resolve(o).then((function(n){e[i]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Me)return e;if(e&&"function"===typeof e.then)return new Me((function(t,n){e.then(t,n)}));var t=new Me(he,!0,e);return ze(t,Te),t},reject:Je,race:function(){var e=F.apply(null,arguments).map(at);return new Me((function(t,n){e.map((function(e){return Me.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Ce},set:function(e){return Ce=e}},newPSD:rt,usePSD:lt,scheduler:{get:function(){return Se},set:function(e){Se=e}},rejectionMapper:{get:function(){return Pe},set:function(e){Pe=e}},follow:function(e,t){return new Me((function(n,r){return rt((function(t,n){var r=Ce;r.unhandleds=[],r.onunhandled=n,r.finalize=ce((function(){var e=this;!function(e){function t(){e(),Ne.splice(Ne.indexOf(t),1)}Ne.push(t),++Re,Se((function(){0===--Re&&Ye()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),we&&(we.allSettled&&h(Me,"allSettled",(function(){var e=F.apply(null,arguments).map(at);return new Me((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,o){return Me.resolve(e).then((function(e){return r[o]={status:"fulfilled",value:e}}),(function(e){return r[o]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),we.any&&"undefined"!==typeof AggregateError&&h(Me,"any",(function(){var e=F.apply(null,arguments).map(at);return new Me((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach((function(e,i){return Me.resolve(e).then((function(e){return t(e)}),(function(e){o[i]=e,--r||n(new AggregateError(o))}))}))}))})));var $e={awaits:0,echoes:0,id:0},Qe=0,Ze=[],et=0,tt=0,nt=0;function rt(e,t,n,r){var o=Ce,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++nt;var a=Ie.env;i.env=_e?{Promise:Me,PromiseProp:{value:Me,configurable:!0,writable:!0},all:Me.all,race:Me.race,allSettled:Me.allSettled,any:Me.any,resolve:Me.resolve,reject:Me.reject,nthen:pt(a.nthen,i),gthen:pt(a.gthen,i)}:{},t&&c(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=lt(i,e,n,r);return 0===i.ref&&i.finalize(),u}function ot(){return $e.id||($e.id=++Qe),++$e.awaits,$e.echoes+=100,$e.id}function it(e){!$e.awaits||e&&e!==$e.id||(0===--$e.awaits&&($e.id=0),$e.echoes=100*$e.awaits)}function at(e){return $e.echoes&&e&&e.constructor===we?(ot(),e.then((function(e){return it(),e}),(function(e){return it(),yt(e)}))):e}function ut(e){++tt,$e.echoes&&0!==--$e.echoes||($e.echoes=$e.id=0),Ze.push(Ce),st(e,!0)}function ct(){var e=Ze[Ze.length-1];Ze.pop(),st(e,!1)}function st(e,t){var n,r=Ce;if((t?!$e.echoes||et++&&e===Ce:!et||--et&&e===Ce)||(n=t?ut.bind(null,e):ct,ge.call(ve,n)),e!==Ce&&(Ce=e,r===Ie&&(Ie.env=ft()),_e)){var o=Ie.env.Promise,i=e.env;be.then=i.nthen,o.prototype.then=i.gthen,(r.global||e.global)&&(Object.defineProperty(u,"Promise",i.PromiseProp),o.all=i.all,o.race=i.race,o.resolve=i.resolve,o.reject=i.reject,i.allSettled&&(o.allSettled=i.allSettled),i.any&&(o.any=i.any))}}function ft(){var e=u.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:be.then,gthen:e.prototype.then}:{}}function lt(e,t,n,r,o){var i=Ce;try{return st(e,!0),t(n,r,o)}finally{st(i,!1)}}function dt(e,t,n){return"function"!==typeof e?e:function(){var r=Ce;n&&ot(),st(t,!0);try{return e.apply(this,arguments)}finally{st(r,!1)}}}function pt(e,t){return function(n,r){return e.call(this,dt(n,t,!1),dt(r,t,!1))}}-1===(""+ge).indexOf("[native code]")&&(ot=it=ie);function ht(e,t){var n;try{n=t.onuncatched(e)}catch(i){}if(!1!==n)try{var r,o={promise:t,reason:e};if(u.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(r,o)):u.CustomEvent&&c(r=new CustomEvent("unhandledrejection",{detail:o}),o),r&&u.dispatchEvent&&(dispatchEvent(r),!u.PromiseRejectionEvent&&u.onunhandledrejection))try{u.onunhandledrejection(r)}catch(a){}L&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(i){}}var yt=Me.reject;var vt=String.fromCharCode(65535),bt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",mt=[],gt="undefined"!==typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=gt,_t=gt,Ot=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function Et(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var St={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},At=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Ce.trans,o=this.name;function i(e,n,r){if(!r.schema[o])throw new ne.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}var a=He();try{return r&&r.db===this.db?r===Ce.trans?r._promise(e,i,n):rt((function(){return r._promise(e,i,n)}),{trans:r,transless:Ce.transless||Ce}):function e(t,n,r,o){if(t._state.openComplete||Ce.letThrough){var i=t._createTransaction(n,r,t._dbSchema);try{i.create()}catch(a){return yt(a)}return i._promise(n,(function(e,t){return rt((function(){return Ce.trans=i,o(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return yt(new ne.DatabaseClosed);t.open().catch(ie)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,o)}))}(this.db,e,[this.name],i)}finally{a&&We()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"===typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==vt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&L&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,o=this.db._deps.indexedDB;function u(e,t){try{return 0===o.cmp(e,t)}catch(n){return!1}}var c=t.reduce((function(t,n){var o=t[0],i=t[1],c=r[n],s=e[n];return[o||c,o||!c?Et(i,c&&c.multi?function(e){var t=E(e,n);return a(t)&&t.some((function(e){return u(s,e)}))}:function(e){return u(s,E(e,n))}):i]}),[null,null]),s=c[0],f=c[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(l(t,r))try{n[r]=t[r]}catch(o){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},e.prototype.add=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[e]})})).then((function(e){return e.numFailures?Me.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{S(e,n.core.schema.primaryKey.keyPath,t)}catch(r){}return t}))},e.prototype.update=function(e,t){if("object"!==typeof t||a(t))throw new ne.InvalidArgument("Modifications must be an object.");if("object"!==typeof e||a(e))return this.where(":id").equals(e).modify(t);i(t).forEach((function(n){S(e,n,t[n])}));var n=E(e,this.schema.primKey.keyPath);return void 0===n?yt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this;return this._trans("readwrite",(function(r){return n.core.mutate({trans:r,type:"put",values:[e],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Me.reject(e.failures[0]):e.lastResult})).then((function(t){if(!n.core.schema.primaryKey.outbound)try{S(e,n.core.schema.primaryKey.keyPath,t)}catch(r){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Me.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:St})})).then((function(e){return e.numFailures?Me.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&o)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"add",keys:o,values:e,wantResults:i}).then((function(e){var t=e.numFailures,o=e.results,a=e.lastResult,u=e.failures;if(0===t)return i?o:a;throw new Z(r.name+".bulkAdd(): "+t+" of "+n+" operations failed",Object.keys(u).map((function(e){return u[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&o)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var n=e.length;return r.core.mutate({trans:t,type:"put",keys:o,values:e,wantResults:i}).then((function(e){var t=e.numFailures,o=e.results,a=e.lastResult,u=e.failures;if(0===t)return i?o:a;throw new Z(r.name+".bulkPut(): "+t+" of "+n+" operations failed",Object.keys(u).map((function(e){return u[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,o=e.lastResult,i=e.failures;if(0===r)return o;throw new Z(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",i)}))},e}();function kt(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"===typeof n)return t[n]};n.addEventType=u;for(var r=1,o=arguments.length;r<o;++r)u(arguments[r]);return n;function u(e,r,o){if("object"===typeof e)return c(e);r||(r=de),o||(o=ie);var i={subscribers:[],fire:o,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=r(i.fire,e))},unsubscribe:function(e){i.subscribers=i.subscribers.filter((function(t){return t!==e})),i.fire=i.subscribers.reduce(r,o)}};return t[e]=n[e]=i,i}function c(e){i(e).forEach((function(t){var n=e[t];if(a(n))u(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ne.InvalidArgument("Invalid event config");var r=u(t,ae,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){_((function(){e.apply(null,t)}))}))}))}}))}}function xt(e,t){return y(t).from({prototype:e}),t}function jt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Tt(e,t){e.filter=Et(e.filter,t)}function Pt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Et(r(),t())}:t,e.justLimit=n&&!r}function It(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Ct(e,t,n){var r=It(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Dt(e,t,n,r){var o=e.replayFilter?Et(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},a=function(e,n,r){if(!o||o(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),l(i,u)||(i[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Rt(Ct(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Rt(Ct(e,r,n),Et(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function Rt(e,t,n,r){var o=Xe(r?function(e,t,o){return n(r(e),t,o)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ie}),(function(t){e.fail(t),n=ie}))||o(e.value,e,(function(e){return n=e})),n()}))}))}var Nt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,yt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,yt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Et(t.algorithm,e)},e.prototype._iterate=function(e,t){return Dt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Dt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(jt(n,!0))return r.count({trans:e,query:{index:It(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var o=0;return Dt(n,(function(){return++o,!1}),e,r).then((function(){return o}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=i(e,o),r=i(t,o);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&jt(n,!0)&&n.limit>0){var r=n.valueMapper,o=It(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var i=[];return Dt(n,(function(e){return i.push(e)}),e,n.table.core).then((function(){return i}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,jt(t)?Pt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Pt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Pt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Tt(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Tt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Et(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&jt(t,!0)&&t.limit>0)return this._read((function(e){var n=It(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Tt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=l(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var o;if("function"===typeof e)o=e;else{var a=i(e),u=a.length;o=function(t){for(var n=!1,r=0;r<u;++r){var o=a[r],i=e[o];E(t,o)!==i&&(S(t,o,i),n=!0)}return n}}var c=n.table.core,s=c.schema.primaryKey,f=s.outbound,l=s.extractKey,d="testmode"in kn?1:2e3,p=t.db.core.cmp,h=[],y=0,v=[],b=function(e,t){var n=t.failures,r=t.numFailures;y+=e-r;for(var o=0,a=i(n);o<a.length;o++){var u=a[o];h.push(n[u])}};return t.clone().primaryKeys().then((function(e){return function t(n){var i=Math.min(d,e.length-n);return c.getMany({trans:r,keys:e.slice(n,n+i)}).then((function(a){for(var u=[],s=[],h=f?[]:null,y=[],v=0;v<i;++v){var m=a[v],g={value:I(m),primKey:e[n+v]};!1!==o.call(g,g.value,g)&&(null==g.value?y.push(e[n+v]):f||0===p(l(m),l(g.value))?(s.push(g.value),f&&h.push(e[n+v])):(y.push(e[n+v]),u.push(g.value)))}return Promise.resolve(u.length>0&&c.mutate({trans:r,type:"add",values:u}).then((function(e){for(var t in e.failures)y.splice(parseInt(t),1);b(u.length,e)}))).then((function(e){return s.length>0&&c.mutate({trans:r,type:"put",keys:h,values:s}).then((function(e){return b(s.length,e)}))})).then((function(){return y.length>0&&c.mutate({trans:r,type:"delete",keys:y}).then((function(e){return b(y.length,e)}))})).then((function(){return e.length>n+i&&t(n+d)}))}))}(0).then((function(){if(h.length>0)throw new Q("Error modifying one or more objects",h,y,v);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return jt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new Q("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Mt(e,t){return e<t?-1:e===t?0:1}function Bt(e,t){return e>t?-1:e===t?0:1}function Kt(e,t,n){var r=e instanceof zt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Ft(e){return new e.Collection(e,(function(){return Vt("")})).limit(0)}function Ut(e,t,n,r,o,i){for(var a=Math.min(e.length,r.length),u=-1,c=0;c<a;++c){var s=t[c];if(s!==r[c])return o(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):o(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;o(e[c],s)<0&&(u=c)}return a<r.length&&"next"===i?e+n.substr(e.length):a<e.length&&"prev"===i?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function Lt(e,t,n,r){var o,i,a,u,c,s,f,l=n.length;if(!n.every((function(e){return"string"===typeof e})))return Kt(e,"String expected.");function d(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),i=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Mt:Bt;var t=n.map((function(e){return{lower:i(e),upper:o(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));u=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),s=e,f="next"===e?"":r}d("next");var p=new e.Collection(e,(function(){return qt(u[0],c[l-1]+r)}));p._ondirectionchange=function(e){d(e)};var h=0;return p._addAlgorithm((function(e,n,r){var o=e.key;if("string"!==typeof o)return!1;var d=i(o);if(t(d,c,h))return!0;for(var p=null,y=h;y<l;++y){var v=Ut(o,d,u[y],c[y],a,s);null===v&&null===p?h=y+1:(null===p||a(p,v)>0)&&(p=v)}return n(null!==p?function(){e.continue(p+f)}:r),!1})),p}function qt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Vt(e){return{type:1,lower:e,upper:e}}var zt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Ft(this):new this.Collection(this,(function(){return qt(e,t,!n,!r)}))}catch(o){return Kt(this,bt)}},e.prototype.equals=function(e){return new this.Collection(this,(function(){return Vt(e)}))},e.prototype.above=function(e){return null==e?Kt(this,bt):new this.Collection(this,(function(){return qt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Kt(this,bt):new this.Collection(this,(function(){return qt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Kt(this,bt):new this.Collection(this,(function(){return qt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Kt(this,bt):new this.Collection(this,(function(){return qt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!==typeof e?Kt(this,"String expected."):this.between(e,e+vt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Lt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],vt)},e.prototype.equalsIgnoreCase=function(e){return Lt(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=F.apply(K,arguments);return 0===e.length?Ft(this):Lt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=F.apply(K,arguments);return 0===e.length?Ft(this):Lt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,vt)},e.prototype.anyOf=function(){var e=this,t=F.apply(K,arguments),n=this._cmp;try{t.sort(n)}catch(i){return Kt(this,bt)}if(0===t.length)return Ft(this);var r=new this.Collection(this,(function(){return qt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm((function(e,r,i){for(var a=e.key;n(a,t[o])>0;)if(++o===t.length)return r(i),!1;return 0===n(a,t[o])||(r((function(){e.continue(t[o])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-(1/0),e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=F.apply(K,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(n){return Kt(this,bt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-(1/0),t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,o=this._ascending,i=this._descending,a=this._min,u=this._max;if(0===e.length)return Ft(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return Kt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var c=!t||!1!==t.includeLowers,s=t&&!0===t.includeUppers;var f,l=o;function d(e,t){return l(e[0],t[0])}try{(f=e.reduce((function(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=u(i[1],t[1]);break}}return n===o&&e.push(t),e}),[])).sort(d)}catch(m){return Kt(this,bt)}var p=0,h=s?function(e){return o(e,f[p][1])>0}:function(e){return o(e,f[p][1])>=0},y=c?function(e){return i(e,f[p][0])>0}:function(e){return i(e,f[p][0])>=0};var v=h,b=new this.Collection(this,(function(){return qt(f[0][0],f[f.length-1][1],!c,!s)}));return b._ondirectionchange=function(e){"next"===e?(v=h,l=o):(v=y,l=i),f.sort(d)},b._addAlgorithm((function(e,t,r){for(var i=e.key;v(i);)if(++p===f.length)return t(r),!1;return!!function(e){return!h(e)&&!y(e)}(i)||(0===n._cmp(i,f[p][1])||0===n._cmp(i,f[p][0])||t((function(){l===o?e.continue(f[p][0]):e.continue(f[p][1])})),!1)})),b},e.prototype.startsWithAnyOf=function(){var e=F.apply(K,arguments);return e.every((function(e){return"string"===typeof e}))?0===e.length?Ft(this):this.inAnyRange(e.map((function(e){return[e,e+vt]}))):Kt(this,"startsWithAnyOf() only works with strings")},e}();function Gt(e){return 1===e.length?e[0]:e}function Ht(e){try{return e.only([[]]),[[]]}catch(t){return vt}}function Wt(e){return Xe((function(t){return Yt(t),e(t.target.error),!1}))}function Yt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Jt=function(){function e(){}return e.prototype._lock=function(){return w(!Ce.global),++this._reculock,1!==this._reculock||Ce.global||(Ce.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!Ce.global),0===--this._reculock)for(Ce.global||(Ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{lt(e[1],e[0])}catch(t){}}return this},e.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(r);case"MissingAPIError":throw new ne.MissingAPI(r.message,r);default:throw new ne.OpenFailed(r)}if(!this.active)throw new ne.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||n.transaction(Gt(this.storeNames),this.mode)).onerror=Xe((function(n){Yt(n),t._reject(e.error)})),e.onabort=Xe((function(n){Yt(n),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Xe((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return yt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return yt(new ne.TransactionInactive);if(this._locked())return new Me((function(o,i){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,i)},Ce])}));if(n)return rt((function(){var e=new Me((function(e,n){r._lock();var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var o=new Me((function(e,n){var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Me.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new Me((function(e,r){n.then((function(n){return t._waitingQueue.push(Xe(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Xe(r.bind(null,e)))})).finally((function(){t._waitingFor===o&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new ne.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Xt(e,t,n,r,o,i,a){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+$t(t)}}function $t(e){return"string"===typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Qt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:O(n,(function(e){return[e.name,e]}))}}function Zt(e){return null==e?function(){}:"string"===typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return E(t,e)}}(e):function(t){return E(t,e)}}function en(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function tn(e){return[].slice.call(e)}var nn=0;function rn(e){return null==e?":id":"string"===typeof e?e:"["+e.join("+")+"]"}function on(e,t,n,r){var i=t.cmp.bind(t);function u(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,o=e.lowerOpen,i=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!i):void 0===r?n.lowerBound(t,!!o):n.bound(t,r,!!o,!!i)}var c=function(e,t){var n=tn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),o=null==t,i={},u={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Zt(t)},indexes:tn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,u={name:t,compound:a(o),keyPath:o,unique:n,multiEntry:r,extractKey:Zt(o)};return i[rn(o)]=u,u})),getIndexByKeyPath:function(e){return i[rn(e)]}};return i[":id"]=u.primaryKey,null!=t&&(i[rn(t)]=u.primaryKey),u}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=c.schema,f=c.hasGetAll,l=s.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,i=n.type,a=n.keys,c=n.values,s=n.range,f=n.wantResults;return new Promise((function(n,l){n=Xe(n);var d=r.objectStore(t),p=null==d.keyPath,h="put"===i||"add"===i;if(!h&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var y=(a||c||{length:1}).length;if(a&&c&&a.length!==c.length)throw new Error("Given keys array must have same length as given values array.");if(0===y)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var v,b=f&&o(a||en(e.primaryKey,{type:i,keys:a,values:c})),m=[],g=0,w=function(e){++g,Yt(e),b&&(b[e.target._reqno]=void 0),m[e.target._reqno]=e.target.error},_=function(e){var t=e.target;b[t._reqno]=t.result};if("deleteRange"===i){if(4===s.type)return n({numFailures:g,failures:m,results:b,lastResult:void 0});v=3===s.type?d.clear():d.delete(u(s))}else{var O=h?p?[c,a]:[c,null]:[a,null],E=O[0],S=O[1];if(h)for(var A=0;A<y;++A)(v=S&&void 0!==S[A]?d[i](E[A],S[A]):d[i](E[A]))._reqno=A,b&&void 0===b[A]&&(v.onsuccess=_),v.onerror=w;else for(A=0;A<y;++A)(v=d[i](E[A]))._reqno=A,v.onerror=w}var k=function(e){var t=e.target.result;b&&(b[y-1]=t),n({numFailures:g,failures:m,results:b,lastResult:t})};v.onerror=function(e){w(e),k(e)},v.onsuccess=k}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,o){e=Xe(e);for(var i,a=n.objectStore(t),u=r.length,c=new Array(u),s=0,f=0,l=function(t){var n=t.target;c[n._pos]=n.result,++f===s&&e(c)},d=Wt(o),p=0;p<u;++p)null!=r[p]&&((i=a.get(r[p]))._pos=p,i.onsuccess=l,i.onerror=d,++s);0===s&&e(c)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,o){e=Xe(e);var i=n.objectStore(t).get(r);i.onsuccess=function(t){return e(t.target.result)},i.onerror=Wt(o)}))},query:function(e){return function(n){return new Promise((function(r,o){r=Xe(r);var i=n.trans,a=n.values,c=n.limit,s=n.query,f=c===1/0?void 0:c,l=s.index,d=s.range,p=i.objectStore(t),h=l.isPrimaryKey?p:p.index(l.name),y=u(d);if(0===c)return r({result:[]});if(e){var v=a?h.getAll(y,f):h.getAllKeys(y,f);v.onsuccess=function(e){return r({result:e.target.result})},v.onerror=Wt(o)}else{var b=0,m=a||!("openKeyCursor"in h)?h.openCursor(y):h.openKeyCursor(y),g=[];m.onsuccess=function(e){var t=m.result;return t?(g.push(a?t.value:t.primaryKey),++b===c?r({result:g}):void t.continue()):r({result:g})},m.onerror=Wt(o)}}))}}(f),openCursor:function(e){var n=e.trans,r=e.values,o=e.query,i=e.reverse,a=e.unique;return new Promise((function(e,c){e=Xe(e);var s=o.index,f=o.range,l=n.objectStore(t),d=s.isPrimaryKey?l:l.index(s.name),p=i?a?"prevunique":"prev":a?"nextunique":"next",h=r||!("openKeyCursor"in d)?d.openCursor(u(f),p):d.openKeyCursor(u(f),p);h.onerror=Wt(c),h.onsuccess=Xe((function(t){var r=h.result;if(r){r.___id=++nn,r.done=!1;var o=r.continue.bind(r),i=r.continuePrimaryKey;i&&(i=i.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Xe(c),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Xe(e),h.onerror=Wt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,e(t)}})),n=function(){if(h.result)try{e()}catch(t){r.fail(t)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return h.onsuccess=Xe((function(e){h.onsuccess=n,n()})),r.continue=o,r.continuePrimaryKey=i,r.advance=a,n(),t},e(r)}else e(null)}),c)}))},count:function(e){var n=e.query,r=e.trans,o=n.index,i=n.range;return new Promise((function(e,n){var a=r.objectStore(t),c=o.isPrimaryKey?a:a.index(o.name),s=u(i),f=s?c.count(s):c.count();f.onsuccess=Xe((function(t){return e(t.target.result)})),f.onerror=Wt(n)}))}}}(e)})),d={};return l.forEach((function(e){return d[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw new Error("Table '"+e+"' not found");return d[e]},cmp:i,MIN_KEY:-1/0,MAX_KEY:Ht(n),schema:s}}function an(e,t,n,o){var i=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(on(t,n.indexedDB,i,o),e.dbcore)}}function un(e,t){var n=t.db,r=an(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function cn(e,t,n,r){n.forEach((function(n){var o=r[n];t.forEach((function(t){n in t||(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get:function(){return this.table(n)},set:function(e){p(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function sn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function fn(e,t){return e._cfg.version-t._cfg.version}function ln(e,t,n,r){var o=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,o);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),c=Ce.transless||Ce;rt((function(){Ce.trans=a,Ce.transless=c,0===t?(i(o).forEach((function(e){dn(n,e,o[e].primKey,o[e].indexes)})),un(e,n),Me.follow((function(){return e.on.populate.fire(a)})).catch(u)):function(e,t,n,r){var o=[],a=e._versions,u=e._dbSchema=hn(e,e.idbdb,r),c=!1;function s(){return o.length?Me.resolve(o.shift()(n.idbtrans)).then(s):Me.resolve()}return a.filter((function(e){return e._cfg.version>=t})).forEach((function(a){o.push((function(){var o=u,s=a._cfg.dbschema;yn(e,o,r),yn(e,s,r),u=e._dbSchema=s;var f=function(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],i=t[n];if(o){var a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(o.primKey.src===i.primKey.src||gt){var u=o.idxByName,c=i.idxByName,s=void 0;for(s in u)c[s]||a.del.push(s);for(s in c){var f=u[s],l=c[s];f?f.src!==l.src&&a.change.push(l):a.add.push(l)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}else a.recreate=!0,r.change.push(a)}else r.add.push([n,i])}return r}(o,s);f.add.forEach((function(e){dn(r,e[0],e[1].primKey,e[1].indexes)})),f.change.forEach((function(e){if(e.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return pn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),pn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=a._cfg.contentUpgrade;if(l&&a._cfg.version>t){un(e,r),c=!0;var d=A(s);f.del.forEach((function(e){d[e]=o[e]})),sn(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],i(d),d),n.schema=d;var p,h=U(l);h&&ot();var y=Me.follow((function(){if((p=l(n))&&h){var e=it.bind(null,null);p.then(e,e)}}));return p&&"function"===typeof p.then?Me.resolve(p):y.then((function(){return p}))}})),o.push((function(t){c&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(a._cfg.dbschema,t);sn(e,[e.Transaction.prototype]),cn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),s().then((function(){var e,t;t=r,i(e=u).forEach((function(n){t.db.objectStoreNames.contains(n)||dn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,a,n).catch(u)}))}function dn(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return pn(o,e)})),o}function pn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hn(e,t,n){var r={};return m(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),o=t.keyPath,i=Xt($t(o),o||"",!1,!1,!!t.autoIncrement,o&&"string"!==typeof o,!0),a=[],u=0;u<t.indexNames.length;++u){var c=t.index(t.indexNames[u]);o=c.keyPath;var s=Xt(c.name,o,!!c.unique,!!c.multiEntry,!1,o&&"string"!==typeof o,!1);a.push(s)}r[e]=Qt(e,i,a)})),r}function yn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var i=r[o],a=n.objectStore(i);e._hasGetAll="getAll"in a;for(var c=0;c<a.indexNames.length;++c){var s=a.indexNames[c],f=a.index(s).keyPath,l="string"===typeof f?f:"["+m(f).join("+")+"]";if(t[i]){var d=t[i].idxByName[l];d&&(d.name=s,delete t[i].idxByName[l],t[i].idxByName[s]=d)}}}"undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var vn,bn=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){i(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Xt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)})),o=r.shift();if(o.multi)throw new ne.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")})),t[n]=Qt(n,o,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},o={};return n.forEach((function(e){c(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,sn(t,[t._allTables,t,t.Transaction.prototype]),cn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function mn(e){return rt((function(){return Ce.letThrough=!0,e()}))}function gn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?yt(t.dbOpenError):e}));L&&(t.openCanceller._stackHolder=G()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,o=null;return Me.race([t.openCanceller,new Me((function(r,a){if(!n)throw new ne.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var u=e.name,c=t.autoSchema?n.open(u):n.open(u,Math.round(10*e.verno));if(!c)throw new ne.MissingAPI("IndexedDB API not available");c.onerror=Wt(a),c.onblocked=Xe(e._fireOnBlocked),c.onupgradeneeded=Xe((function(r){if(o=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Yt,o.abort(),c.result.close();var i=n.deleteDatabase(u);i.onsuccess=i.onerror=Xe((function(){a(new ne.NoSuchDatabase("Database "+u+" doesnt exist"))}))}else{o.onerror=Wt(a);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=c.result,ln(e,s/10,o,a)}}),a),c.onsuccess=Xe((function(){o=null;var n=e.idbdb=c.result,a=m(n.objectStoreNames);if(a.length>0)try{var s=n.transaction(Gt(a),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=hn(0,t,n);e._storeNames=m(t.objectStoreNames,0),cn(e,[e._allTables],i(r),r)}(e,n,s):yn(e,e._dbSchema,s),un(e,s)}catch(f){}mt.push(e),n.onversionchange=Xe((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),vn.add(u),r()}),a)}))]).then((function(){return t.onReadyBeingFired=[],Me.resolve(mn(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(pe,ie);return t.onReadyBeingFired=[],Me.resolve(mn(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{o&&o.abort()}catch(r){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,yt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function wn(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),i=o.value;return o.done?i:i&&"function"===typeof i.then?i.then(n,r):a(i)?Promise.all(i).then(n,r):n(i)}}return o(t)()}function _n(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];n=o.pop();var i=x(o);return[e,i,n]}function On(e,t,n,r,o){return Me.resolve().then((function(){var i=Ce.transless||Ce,a=e._createTransaction(t,n,e._dbSchema,r),u={trans:a,transless:i};r?a.idbtrans=r.idbtrans:a.create();var c,s=U(o);s&&ot();var f=Me.follow((function(){if(c=o.call(a,a))if(s){var e=it.bind(null,null);c.then(e,e)}else"function"===typeof c.next&&"function"===typeof c.throw&&(c=wn(c))}),u);return(c&&"function"===typeof c.then?Me.resolve(c).then((function(e){return a.active?e:yt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):f.then((function(){return c}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),yt(e)}))}))}function En(e,t,n){for(var r=a(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Sn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema,i={},a=[];function u(e,t,n){var o=rn(e),c=i[o]=i[o]||[],s=null==e?0:"string"===typeof e?1:e.length,f=t>0,l=r(r({},n),{isVirtual:f,isPrimaryKey:!f&&n.isPrimaryKey,keyTail:t,keyLength:s,extractKey:Zt(e),unique:!f&&n.unique});(c.push(l),l.isPrimaryKey||a.push(l),s>1)&&u(2===s?e[0]:e.slice(0,s-1),t+1,n);return c.sort((function(e,t){return e.keyTail-t.keyTail})),l}var c=u(o.primaryKey.keyPath,0,o.primaryKey);i[":id"]=[c];for(var s=0,f=o.indexes;s<f.length;s++){var l=f[s];u(l.keyPath,0,l)}function d(t){var n,o,i=t.query.index;return i.isVirtual?r(r({},t),{query:{index:i,range:(n=t.query.range,o=i.keyTail,{type:1===n.type?2:n.type,lower:En(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:En(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},o),{primaryKey:c,indexes:a,getIndexByKeyPath:function(e){var t=i[rn(e)];return t&&t[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,o=r.keyTail,i=r.isVirtual,a=r.keyLength;if(!i)return n.openCursor(t);return n.openCursor(d(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(En(r,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(En(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(En(t,e.MAX_KEY,o),r)}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},An={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var a=Ce.trans,u=a.table(t).hook,c=u.deleting,s=u.creating,f=u.updating;switch(e.type){case"add":if(s.fire===ie)break;return a._promise("readwrite",(function(){return l(e)}),!0);case"put":if(s.fire===ie&&f.fire===ie)break;return a._promise("readwrite",(function(){return l(e)}),!0);case"delete":if(c.fire===ie)break;return a._promise("readwrite",(function(){return l(e)}),!0);case"deleteRange":if(c.fire===ie)break;return a._promise("readwrite",(function(){return function(e){return function e(t,o,a){return n.query({trans:t,values:!1,query:{index:i,range:o},limit:a}).then((function(n){var i=n.result;return l({type:"delete",keys:i,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):i.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},o),{lower:i[i.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function l(e){var t=Ce.trans,a=e.keys||en(i,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:a,wantResults:!0}):r({},e)).type&&(e.values=o(e.values)),e.keys&&(e.keys=o(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,a).then((function(r){var o=a.map((function(n,o){var a=r[o],u={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(u,n,a,t);else if("add"===e.type||void 0===a){var l=s.fire.call(u,n,e.values[o],t);null==n&&null!=l&&(n=l,e.keys[o]=n,i.outbound||S(e.values[o],i.keyPath,n))}else{var d=N(a,e.values[o]),p=f.fire.call(u,d,n,a,t);if(p){var h=e.values[o];Object.keys(p).forEach((function(e){S(h,e,p[e])}))}}return u}));return n.mutate(e).then((function(t){for(var n=t.failures,i=t.results,u=t.numFailures,c=t.lastResult,s=0;s<a.length;++s){var f=i?i[s]:a[s],l=o[s];null==f?l.onerror&&l.onerror(n[s]):l.onsuccess&&l.onsuccess("put"===e.type&&r[s]?e.values[s]:f)}return{failures:n,results:i,numFailures:u,lastResult:c}})).catch((function(e){return o.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}},kn=function(){function e(t,n){var o=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var u,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0};c.dbReadyPromise=new Me((function(e){c.dbReadyResolve=e})),c.openCanceller=new Me((function(e,t){c.cancelOpen=t})),this._state=c,this.name=t,this.on=kt(this,"populate","blocked","versionchange",{ready:[pe,ie]}),this.on.ready.subscribe=g(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=o._state;if(e.openComplete)e.dbOpenError||Me.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var i=o;r||t((function e(){i.on.ready.unsubscribe(n),i.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(u=this,xt(Nt.prototype,(function(e,t){this.db=u;var n=St,r=null;if(t)try{n=t()}catch(c){r=c}var o=e._ctx,i=o.table,a=i.hook.reading.fire;this._ctx={table:i,index:o.index,isPrimKey:!o.index||i.schema.primKey.keyPath&&o.index===i.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:a!==ae?a:null}}))),this.Table=function(e){return xt(At.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:kt(null,{creating:[se,ie],reading:[ue,ae],updating:[le,ie],deleting:[fe,ie]})}))}(this),this.Transaction=function(e){return xt(Jt.prototype,(function(t,n,r,o){var i=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Me((function(e,t){i._resolve=e,i._reject=t})),this._completion.then((function(){i.active=!1,i.on.complete.fire()}),(function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),yt(e)}))}))}(this),this.Version=function(e){return xt(bn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return xt(zt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var o=e._deps.indexedDB;if(!o)throw new ne.MissingAPI("indexedDB API missing");this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(e,t){return o.cmp(t,e)},this._max=function(e,t){return o.cmp(e,t)>0?e:t},this._min=function(e,t){return o.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+o.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+o.name+"'. Closing db now to resume the delete request."),o.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+o.name+"') was blocked"):console.warn("Upgrade '"+o.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=Ht(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){o.on("blocked").fire(e),mt.filter((function(e){return e.name===o.name&&e!==o&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Sn),this.use(An),a.forEach((function(e){return e(o)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(fn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||Ce.letThrough?e():new Me((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ne.DatabaseClosed);t.open().catch(ie)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;o&&this.unuse({stack:t,name:o});var i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:n,level:null==r?10:r,name:o}),i.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return gn(this)},e.prototype.close=function(){var e=mt.indexOf(this),t=this._state;if(e>=0&&mt.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new ne.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Me((function(e){t.dbReadyResolve=e})),t.openCanceller=new Me((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Me((function(r,o){var i=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Xe((function(){vn.remove(e.name),r()})),t.onerror=Wt(o),t.onblocked=e._fireOnBlocked};if(t)throw new ne.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return i(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=_n.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,o=Ce.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var i,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!==typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)i="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ne.InvalidArgument("Invalid transaction mode: "+e);i="readwrite"}if(o){if("readonly"===o.mode&&"readwrite"===i){if(!u)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!u)throw new ne.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),u&&o&&!o.active&&(o=null)}}catch(s){return o?o._promise(null,(function(e,t){t(s)})):yt(s)}var c=On.bind(null,this,i,a,o,n);return o?o._promise(i,c,"lock"):Ce.trans?lt(Ce.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},e.prototype.table=function(e){if(!l(this._allTables,e))throw new ne.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),xn=kn;d(xn,r(r({},oe),{delete:function(e){return new xn(e).delete()},exists:function(e){return new xn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return vn?vn.getDatabaseNames().then(e):Me.resolve([])},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return Ce.trans?lt(Ce.transless,e):e()},vip:mn,async:function(e){return function(){try{var t=wn(e.apply(this,arguments));return t&&"function"===typeof t.then?t:Me.resolve(t)}catch(n){return yt(n)}}},spawn:function(e,t,n){try{var r=wn(e.apply(n,t||[]));return r&&"function"===typeof r.then?r:Me.resolve(r)}catch(o){return yt(o)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(e,t){var n=Me.resolve("function"===typeof e?xn.ignoreTransaction(e):e).timeout(t||6e4);return Ce.trans?Ce.trans.waitFor(n):n},Promise:Me,debug:{get:function(){return L},set:function(e){q(e,"dexie"===e?function(){return!0}:Ot)}},derive:y,extend:c,props:d,override:g,Events:kt,getByKeyPath:E,setByKeyPath:S,delByKeyPath:function(e,t){"string"===typeof t?S(e,t,void 0):"length"in t&&[].map.call(t,(function(t){S(e,t,void 0)}))},shallowClone:A,deepClone:I,getObjectDiff:N,asap:_,minKey:-(1/0),addons:[],connections:mt,errnames:ee,dependencies:function(){try{return{indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.2",version:"3.0.2".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:xn,Dexie:xn})),xn.maxKey=Ht(xn.dependencies.IDBKeyRange),function(e){try{vn=function(e){var t,n=e&&"function"===typeof e.databases;if(!n){var r=new kn("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Me.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&"__dbnames"!==e&&t.put({name:e}).catch(ie)},remove:function(e){return!n&&"__dbnames"!==e&&t.delete(e).catch(ie)}}}(e)}catch(t){}}(kn.dependencies.indexedDB),Me.rejectionMapper=function(e,t){if(!e||e instanceof X||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},q(L,Ot),t.a=kn},16:function(e,t,n){"use strict";var r={$loaded:Promise.resolve(),clientsMeta:[],globalSettings:{muted:[]},chatSettings:{},notifications:!1,audioNotifications:!0},o=localStorage.getItem("dchat");o&&(o=JSON.parse(o),r.clientsMeta=o?[o]:[]);var i,a=localStorage.getItem("dchatv2");a&&((r=JSON.parse(a)).$loaded=Promise.resolve()),i=Proxy?new Proxy(r,{set:function(e,t,n){return"$loaded"!==t&&(e[t]=n,localStorage.setItem("dchatv2",JSON.stringify(e))),!0}}):r,t.a=i},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(32),o=n.n(r),i=n(7),a=n.n(i),u=n(16);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return e.map((function(e){return s(s({},e),{},{active:!1})}))}function l(e){return e.find((function(e){return e.active}))}t.b=function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"nkn/DEACTIVATE_CLIENTS":e=f(i);break;case"nkn/ACTIVATE_CLIENT":n=a.payload.client.wallet.Address,-1===(r=(e=f(i)).findIndex((function(e){return e.wallet.Address===n})))?(t=s(s({},a.payload.client),{},{createdAt:Date.now(),active:!0}),e=[].concat(o()(e),[t])):e[r]=s(s(s({},e[r]),a.payload.client),{},{active:!0}),u.a.clientsMeta=e;break;case"nkn/SET_BALANCE":n=a.payload.address,e=i.map((function(e){var t=s({},e);return t.wallet.Address===n&&(t.balance=a.payload.balance),t})),u.a.clientsMeta=e;break;default:e=i}return e}},167:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return y}));var r=n(3),o=n.n(r),i=n(9),a=n.n(i),u=n(80),c=n.n(u),s=n(21),f=n(119),l=n.n(f),d=n(120),p=n.n(d);function h(e){var t=c()(e),n=p()(e);return e=e.slice(e.indexOf(",")+1),e=l()(e,n),s.a.attachments.add({hash:t,data:e}).catch((function(){})),t}function y(e){return v.apply(this,arguments)}function v(){return(v=a()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.attachments.get({hash:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},169:function(e,t,n){"use strict";(function(e,r){var o,i=n(298);o="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:r;var a=Object(i.a)(o);t.a=a}).call(this,n(13),n(323)(e))},177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"applyMiddleware",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"wrapStore",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"alias",{enumerable:!0,get:function(){return a.default}});var r=u(n(325)),o=u(n(328)),i=u(n(329)),a=u(n(331));function u(e){return e&&e.__esModule?e:{default:e}}},178:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PORT_NAME=t.PATCH_STATE_TYPE=t.STATE_TYPE=t.DISPATCH_TYPE=void 0;t.DISPATCH_TYPE="chromex.dispatch";t.STATE_TYPE="chromex.state";t.PATCH_STATE_TYPE="chromex.patch_state";t.DEFAULT_PORT_NAME="chromex.port_name"},179:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.withSerializer=t.withDeserializer=t.noop=void 0;var i=function(e){return e};t.noop=i;var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return r({},e,e.payload?{payload:t(e.payload)}:{})},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=arguments.length>2?arguments[2]:void 0;return n?function(r){for(var o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];return n.apply(void 0,[r].concat(i))?e.apply(void 0,[a(r,t)].concat(i)):e.apply(void 0,[r].concat(i))}:function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return e.apply(void 0,[a(n,t)].concat(o))}};t.withDeserializer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return function(t){return function(n,r){return t(u(n,e,r))}}};t.withSerializer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];if(o.length<=n)throw new Error("Message in request could not be serialized. "+"Expected message in position ".concat(n," but only received ").concat(o.length," args."));return o[n]=a(o[n],e),t.apply(void 0,o)}}}},180:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DIFF_STATUS_ARRAY_UPDATED=t.DIFF_STATUS_KEYS_UPDATED=t.DIFF_STATUS_REMOVED=t.DIFF_STATUS_UPDATED=void 0;t.DIFF_STATUS_UPDATED="updated";t.DIFF_STATUS_REMOVED="removed";t.DIFF_STATUS_KEYS_UPDATED="updated_keys";t.DIFF_STATUS_ARRAY_UPDATED="updated_array"},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserAPI=function(){var e;try{e=self.chrome||self.browser||browser}catch(t){e=browser}if(!e)throw new Error("Browser API is not present");return e}},21:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(123),o=new r.a("dchat");o.version(1).stores({attachments:"++id,&hash"}),o.version(2).stores({messages:"[topic+id+addr], [topic+createdAt], createdAt",reactions:"[topic+id+addr], [topic+targetID]"}),o.version(3).stores({contacts:"addr"});var i=r.a.maxKey,a=r.a.minKey;t.a=o},296:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=new Audio("img/when.ogg");r.volume=.2;var o=function(){r.play()}},297:function(e,t,n){"use strict";var r=n(56).compose;t.__esModule=!0,t.composeWithDevTools="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}},298:function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},299:function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"===typeof o?o(n,r,e):t(o)}}}}var o=r();o.withExtraArgument=r,t.a=o},300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){if(!e)throw new Error("`createWorkerMiddleware` expects a worker instance as the argument. Instead received: "+e);if(!e.postMessage)throw new Error("The worker instance is expected to have a `postMessage` method.");return function(t){var n=t.dispatch;return e.onmessage=function(e){var t=e.data;n(t)},function(t){if(!t)throw new Error("Worker middleware received no `next` action. Check your chain of middlewares.");return function(n){return n.meta&&n.meta.WebWorker&&e.postMessage(n),t(n)}}}}},301:function(e,t,n){"use strict";var r=n(32),o=n.n(r),i=n(7),a=n.n(i),u=n(56),c=n(16),s=n(166);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=Object(u.combineReducers)({login:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOGIN":e=n.payload.credentials;break;case"LOGIN_STATUS":e=n.error?{error:n.error}:n.payload;break;case"CONNECTED":e=l(l({},t),{},{connected:!0});break;case"LOGOUT":e={};break;default:e=t}return e},clients:s.b,chatSettings:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0,s=null===(e=u.payload)||void 0===e?void 0:e.topic;switch(u.type){case"chat/REMOVE":n=l(l({},i),{},a()({},s,l(l({},i[s]),{},{unread:[],hidden:!0}))),c.a.chatSettings=n;break;case"chat/RECEIVE_MESSAGE":n=l(l({},i),{},a()({},s,l(l({},i[s]),{},{receivedAt:Date.now(),hidden:!1}))),c.a.chatSettings=n;break;case"chat/MARK_UNREAD":r=(null===(t=i[s])||void 0===t?void 0:t.unread)||[],n=l(l({},i),{},a()({},s,l(l({name:s},i[s]),{},{unread:[].concat(o()(r),[u.payload.message.id])}))),c.a.chatSettings=n;break;case"chat/MARK_READ":n=l(l({},i),{},a()({},s,l(l({},i[s]),{},{unread:[]}))),c.a.chatSettings=n;break;case"chat/CREATE_CHAT":n=l(l({},i),{},a()({},s,l(l({name:s,unread:[],subscribers:[],subscribersMeta:[],receivedAt:1},i[s]),{},{hidden:!1}))),c.a.chatSettings=n;break;case"chat/SET_SUBSCRIBERS":n=l(l({},i),{},a()({},s,l(l({},i[s]),{},{subscribers:u.payload.subscribers})));break;case"chat/SET_SUBSCRIPTION_INFOS":n=l(l({},i),{},a()({},s,l(l({unread:[],subscribers:[]},i[s]),{},{subscribersMeta:u.payload.data})));break;case"chat/SET_CHAT_MUTE":n=l(l({},i),{},a()({},s,l(l({},i[s]),{},{muted:u.payload.muted}))),c.a.chatSettings=n;break;default:n=i}return n},messageEvent:function(e,t){var n={};switch(t.type){case"chat/MODIFY_MESSAGE":n={topic:t.payload.topic,message:t.payload.message,type:"modify"};break;case"chat/RECEIVE_MESSAGE":n={topic:t.payload.topic,message:t.payload.message,type:"new"};break;case"chat/RECEIVE_REACTION":n={topic:t.payload.topic,reaction:t.payload.message,type:"new"};break;default:n={}}return n},globalSettings:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{muted:[]},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"settings/TOGGLE_USER_MUTE":e=t.muted.includes(n.payload.addr)?l(l({},t),{},{muted:t.muted.filter((function(e){return e!==n.payload.addr}))}):l(l({},t),{},{muted:[].concat(o()(t.muted),[n.payload.addr])}),c.a.globalSettings=e;break;default:e=t}return e},contactEvent:function(e,t){var n;switch(t.type){case"contacts/UPDATE_CONTACT":n=t.payload.contact;break;default:n={}}return n},navigation:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mostRecentPage:"/"},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"ui/NAVIGATED":e=l(l({},t),{},{mostRecentPage:n.payload.to});break;default:e=t}return e},activeTopics:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,o=null===(e=r.payload)||void 0===e?void 0:e.topic;switch(r.type){case"chat/CREATE_CHAT":(t=new Set(n)).add(o),t=Array.from(t);break;case"ui/REMOVE_ACTIVE_TOPIC":case"chat/REMOVE":t=n.filter((function(e){return e!==o}));break;default:t=n}return t}})},302:function(e,t,n){"use strict";var r=n(7),o=n.n(r),i=n(10),a=n(2),u=n(118),c=n.n(u);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){return function(t,n){var r;if(!(null===(r=e.meta)||void 0===r?void 0:r.WebWorker)){var o,i,a="LOGIN_ALIAS"===e.type&&(null===(o=n().clients.find((function(t){return t.wallet.Address===e.payload.address})))||void 0===o?void 0:o.wallet);switch(t(f(f({},e),{},{payload:f({wallet:a},e.payload),meta:f(f({},e.meta),{},{WebWorker:!0})})),e.type){case"LOGOUT_ALIAS":localStorage.clear();break;case"LOGIN_ALIAS":(i=e.payload.credentials).rememberMe&&c.a.encrypt("d-chat!!!",i).then((function(e){return localStorage.setItem("credentials",JSON.stringify(e))}))}}}};t.a={PUBLISH_MESSAGE_ALIAS:l,LOGIN_ALIAS:l,"chat/GET_SUBSCRIBERS_ALIAS":l,LOGOUT_ALIAS:l,"nkn/GET_BALANCE_ALIAS":l,"nkn/NEW_TRANSACTION_ALIAS":l,SUBSCRIBE_TO_CHAT_ALIAS:l,SEND_PRIVATE_MESSAGE_ALIAS:l,"chat/MAYBE_OFFER_SUBSCRIBE_ALIAS":l,"chat/FETCH_SUBSCRIPTION_INFOS_ALIAS":l,"chat/UNSUBSCRIBE_ALIAS":l,"chat/ACCEPT_TO_CHATROOM_ALIAS":l,"chat/REMOVE_ACCEPT_TO_CHATROOM_ALIAS":l,"contacts/REQUEST_CONTACT":l,"contacts/SEND_CONTACT_INFO":l,JOIN_CHAT_ALIAS:function(e){return function(t){var n=e.payload.topic;n&&(t(Object(i.c)(n)),Object(a.u)(n)&&t(Object(i.x)(n)))}}}},303:function(e,t,n){"use strict";var r=n(304),o=n.n(r),i=n(2),a=n(4),u=n(10),c=function(e){return Object.values(e.chatSettings).reduce((function(e,t){return t.muted?e:e+((null===(n=t.unread)||void 0===n?void 0:n.length)||0);var n}),0)};t.a=function(e){return function(t){return function(n){var r,s,f,l,d,p=null===(r=n.payload)||void 0===r?void 0:r.message,h=null===(s=n.payload)||void 0===s?void 0:s.topic,y=e.getState(),v=(null===p||void 0===p?void 0:p.content)||"";switch(n.type){case"chat/RECEIVE_MESSAGE":!(null===(f=Object(a.c)())||void 0===f?void 0:f.includes(p.topic))&&function(e){return!Object(i.s)(e)&&!e.isMe&&!e.ignored}(p)&&e.dispatch(Object(u.k)(p.topic,p)),d=p,Object(i.s)(d)||Object(i.r)(d)||!Object(i.v)(d)||d.ignored||function(t){var n=t.id,r=t.topic;t.isMe||e.dispatch(Object(u.t)({contentType:"receipt",topic:r,targetID:n}))}(p);break;case"chat/MARK_UNREAD":v="media"===p.contentType?Object(a.a)("Posted media."):o()(v),(null===(l=y.chatSettings[h])||void 0===l?void 0:l.muted)&&!p.refersToMe||(Object(a.b)({message:v,title:p.title||"".concat(Object(a.a)("D-Chat")," ").concat(Object(i.g)(p.topic),", ").concat(Object(i.d)(p.addr),":")}),Object(a.f)(c(y)+1));break;case"chat/MARK_READ":Object(a.f)(c(y)-n.payload.ids.length)}t(n)}}}},304:function(e,t,n){"use strict";var r;!function(o){if("function"!==typeof i){var i=function(e){return e};i.nonNative=!0}var a=i("plaintext"),u=i("html"),c=i("comment"),s=/<(\w*)>/g,f=/<\/?([^\s\/>]+)/;function l(e,t,n){return p(e=e||"",d(t=t||[],n=n||""))}function d(e,t){return{allowable_tags:e=function(e){var t,n=new Set;if("string"===typeof e)for(;t=s.exec(e);)n.add(t[1]);else i.nonNative||"function"!==typeof e[i.iterator]?"function"===typeof e.forEach&&e.forEach(n.add,n):n=new Set(e);return n}(e),tag_replacement:t,state:a,tag_buffer:"",depth:0,in_quote_char:""}}function p(e,t){for(var n=t.allowable_tags,r=t.tag_replacement,o=t.state,i=t.tag_buffer,s=t.depth,f=t.in_quote_char,l="",d=0,p=e.length;d<p;d++){var y=e[d];if(o===a)switch(y){case"<":o=u,i+=y;break;default:l+=y}else if(o===u)switch(y){case"<":if(f)break;s++;break;case">":if(f)break;if(s){s--;break}f="",o=a,i+=">",n.has(h(i))?l+=i:l+=r,i="";break;case'"':case"'":f=y===f?"":f||y,i+=y;break;case"-":"<!-"===i&&(o=c),i+=y;break;case" ":case"\n":if("<"===i){o=a,l+="< ",i="";break}i+=y;break;default:i+=y}else if(o===c)switch(y){case">":"--"==i.slice(-2)&&(o=a),i="";break;default:i+=y}}return t.state=o,t.tag_buffer=i,t.depth=s,t.in_quote_char=f,l}function h(e){var t=f.exec(e);return t?t[1].toLowerCase():null}l.init_streaming_mode=function(e,t){var n=d(e=e||[],t=t||"");return function(e){return p(e||"",n)}},void 0===(r=function(){return l}.call(t,n,t,e))||(e.exports=r)}()},305:function(e,t,n){(function(t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),f=Object.prototype.toString,l=Math.max,d=Math.min,p=function(){return s.Date.now()};function h(e,t,n){var r,o,i,a,u,c,s=0,f=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=r,i=o;return r=o=void 0,s=t,a=e.apply(i,n)}function g(e){return s=e,u=setTimeout(_,t),f?m(e):a}function w(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-s>=i}function _(){var e=p();if(w(e))return O(e);u=setTimeout(_,function(e){var n=t-(e-c);return h?d(n,i-(e-s)):n}(e))}function O(e){return u=void 0,b&&r?m(e):(r=o=void 0,a)}function E(){var e=p(),n=w(e);if(r=arguments,o=this,c=e,n){if(void 0===u)return g(c);if(h)return u=setTimeout(_,t),m(c)}return void 0===u&&(u=setTimeout(_,t)),a}return t=v(t)||0,y(n)&&(f=!!n.leading,i=(h="maxWait"in n)?l(v(n.maxWait)||0,t):i,b="trailing"in n?!!n.trailing:b),E.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},E.flush=function(){return void 0===u?a:O(p())},E}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var u=o.test(e);return u||i.test(e)?a(e.slice(2),u?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return y(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),h(e,t,{leading:r,maxWait:t,trailing:o})}}).call(this,n(13))},306:function(e,t,n){"use strict";t.a=function(e){return function(t){return function(n){switch(n.type){case"chat/RECEIVE_MESSAGE":case"chat/RECEIVE_REACTION":e.getState().globalSettings.muted.includes(n.payload.message.addr)&&(n.payload.message.ignored=!0)}t(n)}}}},307:function(e,t,n){"use strict";var r=n(10),o=n(2);t.a=function(e){return function(t){return function(n){var i,a=null===(i=n.payload)||void 0===i?void 0:i.message;return"chat/RECEIVE_MESSAGE"===n.type&&Object(o.s)(a.contentType)&&a.topic&&e.dispatch(Object(r.f)(a.topic)),t(n)}}}},308:function(e,t,n){"use strict";var r=n(3),o=n.n(r),i=n(9),a=n.n(i),u=n(46),c=n(62);t.a=function(e){return function(t){return function(){var n=a()(o.a.mark((function n(r){var i,a,s,l,d,p,h,y,v,b;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(null===(i=r.type)||void 0===i?void 0:i.startsWith("contacts"))){n.next=42;break}a=r.payload.contact,s=a.requestType,l=r.payload.addr,d=a.addr,n.t0=i,n.next="contacts/RECEIVE_CONTACT_REQUEST"===n.t0?9:"contacts/UPDATE_CONTACT"===n.t0?29:40;break;case 9:n.t1=s,n.next="header"===n.t1?12:"full"===n.t1?21:26;break;case 12:return n.next=14,Object(u.a)(l);case 14:if(n.t2=n.sent,n.t2){n.next=17;break}n.t2={};case 17:return v=n.t2,p=v.version,e.dispatch(Object(c.c)(d,{version:p})),n.abrupt("break",28);case 21:return n.next=23,Object(u.b)(l);case 23:return h=n.sent,e.dispatch(Object(c.c)(d,h)),n.abrupt("break",28);case 26:return console.log("D-Chat: Some odd type came up:",r),n.abrupt("break",28);case 28:return n.abrupt("return");case 29:n.t3=s,n.next="response/header"===n.t3?32:"response/full"===n.t3?37:39;break;case 32:return n.next=34,Object(u.a)(a.addr);case 34:return(y=n.sent)&&y.version===a.version?Object(u.c)(y):e.dispatch(Object(c.b)(a.addr,"full")),n.abrupt("return");case 37:return Object(u.c)(r.payload.contact),n.abrupt("break",39);case 39:return n.abrupt("break",40);case 40:n.next=43;break;case 42:"chat/RECEIVE_MESSAGE"===i&&f((b=r.payload.message).addr).then((function(t){return t&&e.dispatch(Object(c.b)(b.addr,"header"))}));case 43:return n.abrupt("return",t(r));case 44:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}};var s={};function f(e){return l.apply(this,arguments)}function l(){return(l=a()(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s[t]){e.next=2;break}return e.abrupt("return",!1);case 2:return s[t]=!0,e.next=5,Object(u.a)(t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,(r=n.expiresAt)&&!(r>Date.now())){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},311:function(e,t,n){"use strict";var r=n(3),o=n.n(r),i=n(9),a=n.n(i),u=n(2),c=n(58),s=n(7),f=n.n(s),l=n(167),d=n(10);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=[];function v(e){return b.apply(this,arguments)}function b(){return(b=a()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.unreceivable){e.next=11;break}if(!t.modifications){e.next=5;break}return t.isNotConfirmed||(t.modifications=h(h({},t.modifications),t.modifications._onConfirm)),delete t.modifications._onConfirm,e.abrupt("return",Object(c.d)({topic:t.topic,id:t.targetID,addr:t.addr},h({isNotConfirmed:t.isNotConfirmed},t.modifications)).then((function(e){return e&&[Object(d.l)(e)]})));case 5:if("media"===t.contentType&&(t.attachments=t.attachments.map((function(e){return Object(l.b)(e)}))),Object(c.e)(t),!y.includes(t.id)){e.next=10;break}return y=y.filter((function(e){return e!==t.id})),e.abrupt("return",[Object(d.l)(t)]);case 10:t.isNotConfirmed&&y.push(t.id);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=function(){var e=a()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)(t);case 2:return n=e.sent,e.abrupt("return",null!=n||Object(u.r)(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.a=function(e){return function(t){return function(){var n=a()(o.a.mark((function n(r){var i,a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=!1,n.t0=r.type,n.next="chat/RECEIVE_MESSAGE"===n.t0||"chat/RECEIVE_REACTION"===n.t0?4:10;break;case 4:return i=r.payload.message,n.next=7,m(i);case 7:return a=n.sent,v(i).then((function(t){return t.forEach((function(t){return e.dispatch(t)}))})),n.abrupt("break",10);case 10:a||t(r);case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}},315:function(e,t,n){"use strict";n.r(t);var r,o=n(3),i=n.n(o),a=n(9),u=n.n(a),c=n(56),s=n(297),f=n(299),l=n(57),d=n(177),p=function(e){if(localStorage.getItem("dchat")){var t=JSON.parse(localStorage.getItem("dchat"));e.dispatch(Object(l.a)(t))}else var n,r=e.subscribe((function(){var t;if(n!==(n=null===(t=e.getState().clients[0])||void 0===t?void 0:t.addr)){var o=e.getState().clients[0];localStorage.setItem("dchat",JSON.stringify(o)),r()}}))},h=n(300),y=n.n(h),v=n(301),b=n(302),m=n(16),g=n(10),w=n(118),_=n.n(w),O=n(303),E=n(311),S=n(306),A=n(307),k=n(2),x=n(308),j=new Worker("dchat-nkn-worker-injector.js"),T=y()(j);if(k.b&&(r=localStorage.getItem("credentials")))try{r=JSON.parse(r)}catch(I){r=void 0}var P=m.a.$loaded.then(u()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={clients:m.a.clientsMeta,chatSettings:m.a.chatSettings,globalSettings:m.a.globalSettings},n=Object(c.createStore)(v.a,t,Object(s.composeWithDevTools)(Object(c.applyMiddleware)(T,Object(d.alias)(b.a),S.a,x.a,E.a,O.a,A.a,f.a))),p(n),k.b&&r&&_.a.decrypt("d-chat!!!",r).then((function(e){var t=n.getState().clients.find((function(e){return e.active})),r=null===t||void 0===t?void 0:t.wallet.Address;r&&n.dispatch(Object(g.h)(e,r))})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))));t.default=P},32:function(e,t,n){var r=n(332),o=n(333),i=n(183),a=n(334);e.exports=function(e){return r(e)||o(e)||i(e)||a()}},323:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(326)),o=n(178),i=n(179),a=c(n(327)),u=n(181);function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l={portName:o.DEFAULT_PORT_NAME,state:{},extensionId:null,serializer:i.noop,deserializer:i.noop,patchStrategy:a.default},d=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,r=n.portName,a=void 0===r?l.portName:r,c=n.state,f=void 0===c?l.state:c,d=n.extensionId,p=void 0===d?l.extensionId:d,h=n.serializer,y=void 0===h?l.serializer:h,v=n.deserializer,b=void 0===v?l.deserializer:v,m=n.patchStrategy,g=void 0===m?l.patchStrategy:m;if(s(this,e),!a)throw new Error("portName is required in options");if("function"!==typeof y)throw new Error("serializer must be a function");if("function"!==typeof b)throw new Error("deserializer must be a function");if("function"!==typeof g)throw new Error("patchStrategy must be one of the included patching strategies or a custom patching function");this.portName=a,this.readyResolved=!1,this.readyPromise=new Promise((function(e){return t.readyResolve=e})),this.browserAPI=(0,u.getBrowserAPI)(),this.extensionId=p,this.port=this.browserAPI.runtime.connect(this.extensionId,{name:a}),this.safetyHandler=this.safetyHandler.bind(this),this.browserAPI.runtime.onMessage&&(this.safetyMessage=this.browserAPI.runtime.onMessage.addListener(this.safetyHandler)),this.serializedPortListener=(0,i.withDeserializer)(b)((function(){var e;return(e=t.port.onMessage).addListener.apply(e,arguments)})),this.serializedMessageSender=(0,i.withSerializer)(y)((function(){var e;return(e=t.browserAPI.runtime).sendMessage.apply(e,arguments)}),1),this.listeners=[],this.state=f,this.patchStrategy=g,this.serializedPortListener((function(e){switch(e.type){case o.STATE_TYPE:t.replaceState(e.payload),t.readyResolved||(t.readyResolved=!0,t.readyResolve());break;case o.PATCH_STATE_TYPE:t.patchState(e.payload)}})),this.dispatch=this.dispatch.bind(this)}var t,n,a;return t=e,(n=[{key:"ready",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e?this.readyPromise.then(e):this.readyPromise}},{key:"subscribe",value:function(e){var t=this;return this.listeners.push(e),function(){t.listeners=t.listeners.filter((function(t){return t!==e}))}}},{key:"patchState",value:function(e){this.state=this.patchStrategy(this.state,e),this.listeners.forEach((function(e){return e()}))}},{key:"replaceState",value:function(e){this.state=e,this.listeners.forEach((function(e){return e()}))}},{key:"getState",value:function(){return this.state}},{key:"replaceReducer",value:function(){}},{key:"dispatch",value:function(e){var t=this;return new Promise((function(n,i){t.serializedMessageSender(t.extensionId,{type:o.DISPATCH_TYPE,portName:t.portName,payload:e},null,(function(e){var t=e.error,o=e.value;if(t){var a=new Error("".concat("\nLooks like there is an error in the background page. You might want to inspect your background page for more details.\n").concat(t));i((0,r.default)(a,t))}else n(o&&o.payload)}))}))}},{key:"safetyHandler",value:function(e){"storeReady"===e.action&&e.portName===this.portName&&(this.browserAPI.runtime.onMessage.removeListener(this.safetyHandler),this.readyResolved||(this.readyResolved=!0,this.readyResolve()))}}])&&f(t.prototype,n),a&&f(t,a),e}();t.default=d},326:function(e,t){var n="[object GeneratorFunction]",r=/^(?:0|[1-9]\d*)$/;function o(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var i=Object.prototype,a=i.hasOwnProperty,u=i.toString,c=i.propertyIsEnumerable,s=Math.max;function f(e,t){var n=y(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&v(e)}(e)&&a.call(e,"callee")&&(!c.call(e,"callee")||"[object Arguments]"==u.call(e))}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var i in e)!t&&!a.call(e,i)||o&&("length"==i||p(i,r))||n.push(i);return n}function l(e,t,n){var r=e[t];a.call(e,t)&&h(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function d(e){if(!b(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||i;return e===n}(e),n=[];for(var r in e)("constructor"!=r||!t&&a.call(e,r))&&n.push(r);return n}function p(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&e<t}function h(e,t){return e===t||e!==e&&t!==t}var y=Array.isArray;function v(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=b(e)?u.call(e):"";return"[object Function]"==t||t==n}(e)}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var m=function(e){return t=function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,n){if(!b(n))return!1;var r=typeof t;return!!("number"==r?v(n)&&p(t,n.length):"string"==r&&t in n)&&h(n[t],e)}(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t},n=s(void 0===n?t.length-1:n,0),function(){for(var e=arguments,r=-1,i=s(e.length-n,0),a=Array(i);++r<i;)a[r]=e[n+r];r=-1;for(var u=Array(n+1);++r<n;)u[r]=e[r];return u[n]=a,o(t,this,u)};var t,n}((function(e,t){!function(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;l(n,a,void 0===u?e[a]:u)}}(t,function(e){return v(e)?f(e,!0):d(e)}(t),e)}));e.exports=m},327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=Object.assign({},e);return t.forEach((function(e){var t=e.change,o=e.key,i=e.value;switch(t){case r.DIFF_STATUS_UPDATED:n[o]=i;break;case r.DIFF_STATUS_REMOVED:Reflect.deleteProperty(n,o)}})),n};var r=n(180)},328:function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},u={getState:e.getState.bind(e),dispatch:function(){return a.apply(void 0,arguments)}};return n=(n||[]).map((function(e){return e(u)})),a=o.apply(void 0,r(n))(e.dispatch),e.dispatch=a,e}},329:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(178),i=n(179),a=n(181),u=(r=n(330))&&r.__esModule?r:{default:r};var c={portName:o.DEFAULT_PORT_NAME,dispatchResponder:function(e,t){Promise.resolve(e).then((function(e){t({error:null,value:e})})).catch((function(e){console.error("error dispatching result:",e),t({error:e.message,value:null})}))},serializer:i.noop,deserializer:i.noop,diffStrategy:u.default};t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,n=t.portName,r=void 0===n?c.portName:n,u=t.dispatchResponder,s=void 0===u?c.dispatchResponder:u,f=t.serializer,l=void 0===f?c.serializer:f,d=t.deserializer,p=void 0===d?c.deserializer:d,h=t.diffStrategy,y=void 0===h?c.diffStrategy:h;if(!r)throw new Error("portName is required in options");if("function"!==typeof l)throw new Error("serializer must be a function");if("function"!==typeof p)throw new Error("deserializer must be a function");if("function"!==typeof y)throw new Error("diffStrategy must be one of the included diffing strategies or a custom diff function");var v=(0,a.getBrowserAPI)(),b=function(t,n,i){if(t.type===o.DISPATCH_TYPE&&t.portName===r){var a=Object.assign({},t.payload,{_sender:n}),u=null;try{u=e.dispatch(a)}catch(c){u=Promise.reject(c.message),console.error(c)}return s(u,i),!0}},m=function(t){if(t.name===r){var n=(0,i.withSerializer)(l)((function(){return t.postMessage.apply(t,arguments)})),a=e.getState(),u=e.subscribe((function(){var t=e.getState(),r=y(a,t);r.length&&(a=t,n({type:o.PATCH_STATE_TYPE,payload:r}))}));t.onDisconnect.addListener(u),n({type:o.STATE_TYPE,payload:a})}},g=(0,i.withDeserializer)(p),w=function(e){return e.type===o.DISPATCH_TYPE&&e.portName===r};g((function(){var e;return(e=v.runtime.onMessage).addListener.apply(e,arguments)}))(b,w),v.runtime.onMessageExternal?g((function(){var e;return(e=v.runtime.onMessageExternal).addListener.apply(e,arguments)}))(b,w):console.warn("runtime.onMessageExternal is not supported"),v.runtime.onConnect.addListener(m),v.runtime.onConnectExternal?v.runtime.onConnectExternal.addListener(m):console.warn("runtime.onConnectExternal is not supported"),v.tabs.query({},(function(e){var t=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;v.tabs.sendMessage(u.id,{action:"storeReady",portName:r},(function(){chrome.runtime.lastError}))}}catch(c){n=!0,o=c}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}}))}},330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[];return Object.keys(t).forEach((function(o){e[o]!==t[o]&&n.push({key:o,value:t[o],change:r.DIFF_STATUS_UPDATED})})),Object.keys(e).forEach((function(e){t.hasOwnProperty(e)||n.push({key:e,change:r.DIFF_STATUS_REMOVED})})),n};var r=n(180)},331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){return function(){return function(t){return function(n){var r=e[n.type];return t(r?r(n):n)}}}}},332:function(e,t,n){var r=n(182);e.exports=function(e){if(Array.isArray(e))return r(e)}},333:function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},334:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},4:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return v}));var r=n(3),o=n.n(r),i=n(9),a=n.n(i),u=n(296),c=n(305),s=n.n(c),f=n(16);function l(e){return e}var d=function(){},p=s()((function(e){if(f.a.audioNotifications&&Object(u.a)(),f.a.notifications&&e.message)return new Notification(e.title||"D-Chat",{body:e.message||"",icon:"/img/NKN_DCHAT-128-128-border16.png"})}),250,{trailing:!1}),h=function(){return""},y=function(){},v=function(){var e=a()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Notification){e.next=2;break}throw new Error("No Notifications");case 2:return e.next=4,Notification.requestPermission();case 4:if("granted"!==e.sent){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},46:function(e,t,n){"use strict";n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return S}));var r=n(3),o=n.n(r),i=n(7),a=n.n(i),u=n(34),c=n.n(u),s=n(9),f=n.n(s),l=n(80),d=n.n(l),p=n(21),h=n(119),y=n.n(h),v=n(120),b=n.n(v);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){return _.apply(this,arguments)}function _(){return(_=f()(o.a.mark((function e(t){var n,r,i,a,u,s,f,l,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.addr){e.next=2;break}return e.abrupt("return");case 2:return n=t.addr,r=t.content,i=c()(t,["addr","content"]),u=(a=r||{}).avatar,s=c()(a,["avatar"]),"base64"===(null===u||void 0===u?void 0:u.type)&&(u.data&&"string"===typeof u.data?(f=u.data,l=b()(f),f=f.slice(f.indexOf(",")+1),f=y()(f,l),u.data=f,u.type="blob"):(u.data=null,u.type=null)),h=g(g({},i),{},{addr:n,content:g(g({},s),{},{avatar:u}),version:t.version||d()(r||Math.random().toString()),expiresAt:Date.now()+6048e5}),e.abrupt("return",p.a.contacts.put(h));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return(E=f()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",p.a.contacts.get(t).catch((function(e){return console.error("D-CHAT: getContact error:",e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return A.apply(this,arguments)}function A(){return(A=f()(o.a.mark((function e(t){var n,r,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return i=e.t0,e.next=8,k(null===i||void 0===i||null===(n=i.content)||void 0===n||null===(r=n.avatar)||void 0===r?void 0:r.data);case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1="";case 11:return a=e.t1,e.abrupt("return",g(g({},i),{},{content:g(g({},i.content),{},{avatar:{type:"base64",data:a}})}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return e?new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)})):""}},56:function(e,t,n){"use strict";n.r(t),n.d(t,"__DO_NOT_USE__ActionTypes",(function(){return i})),n.d(t,"applyMiddleware",(function(){return v})),n.d(t,"bindActionCreators",(function(){return l})),n.d(t,"combineReducers",(function(){return s})),n.d(t,"compose",(function(){return y})),n.d(t,"createStore",(function(){return u}));var r=n(169),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function a(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,n){var o;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(u)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var c=e,s=t,f=[],l=f,d=!1;function p(){l===f&&(l=f.slice())}function h(){if(d)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return s}function y(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(d)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return p(),l.push(e),function(){if(t){if(d)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,p();var n=l.indexOf(e);l.splice(n,1),f=null}}}function v(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw new Error("Reducers may not dispatch actions.");try{d=!0,s=c(s,e)}finally{d=!1}for(var t=f=l,n=0;n<t.length;n++){(0,t[n])()}return e}function b(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,v({type:i.REPLACE})}function m(){var e,t=y;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(h())}return n(),{unsubscribe:t(n)}}})[r.a]=function(){return this},e}return v({type:i.INIT}),(o={dispatch:v,subscribe:y,getState:h,replaceReducer:b})[r.a]=m,o}function c(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function s(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"===typeof e[o]&&(n[o]=e[o])}var a,u=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof n(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(s){a=s}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,o={},i=0;i<u.length;i++){var s=u[i],f=n[s],l=e[s],d=f(l,t);if("undefined"===typeof d){var p=c(s,t);throw new Error(p)}o[s]=d,r=r||d!==l}return(r=r||u.length!==Object.keys(e).length)?o:e}}function f(e,t){return function(){return t(e.apply(this,arguments))}}function l(e,t){if("function"===typeof e)return f(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in e){var o=e[r];"function"===typeof o&&(n[r]=f(o,t))}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return h({},n,{dispatch:r=y.apply(void 0,i)(n.dispatch)})}}}},579:function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}))}function o(e){return s(r(e))}function i(e){var t=e.replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(t)}function a(e){return i(u(e))}function u(e){return Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("")}function c(e){var t=u(e);return btoa(t)}function s(e){var t;return t="undefined"!==typeof Uint8Array?new Uint8Array(e.length):[],Array.prototype.forEach.call(e,(function(e,n){t[n]=e.charCodeAt(0)})),t}function f(e){return s(atob(e))}e.exports={utf8ToBinaryString:r,utf8ToBuffer:o,utf8ToBase64:function(e){var t=r(e);return btoa(t)},binaryStringToUtf8:i,bufferToUtf8:a,base64ToUtf8:function(e){return i(atob(e))},bufferToBinaryString:u,bufferToBase64:c,binaryStringToBuffer:s,base64ToBuffer:f,strToUtf8Arr:o,utf8ArrToStr:a,arrToBase64:c,base64ToArr:f}},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return m}));var r=n(7),o=n.n(r),i=n(3),a=n.n(i),u=n(9),c=n.n(u),s=n(21);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=25;function p(e){var t=e.topic,n=e.previous,r=void 0===n?{}:n,o=e.extra,i=void 0===o?0:o,a=r.createdAt||s.b;return s.a.messages.where("[topic+createdAt]").between([t,s.c],[t,a],!1,!1).reverse().limit(d+i).sortBy("createdAt").then((function(e){return e.reverse()}))}function h(e){return y.apply(this,arguments)}function y(){return(y=c()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.messages.get(E(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=c()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("reaction"!==t.contentType){e.next=4;break}return e.abrupt("return",w(t));case 4:return e.abrupt("return",_(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=c()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:if(!(r=e.sent)){e.next=6;break}return t=l(l({},r),n),e.abrupt("return",s.a.messages.put(t).then((function(){return t})).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return s.a.reactions.put(e).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)}))}function _(e){return O.apply(this,arguments)}function O(){return(O=c()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:return(n=e.sent)&&(t.createdAt=n.createdAt),e.abrupt("return",s.a.messages.put(t).then((function(){return t})).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return{topic:e.topic,id:e.id,addr:e.addr}}}});