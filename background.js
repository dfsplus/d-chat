!function(e){function t(t){for(var r,a,u=t[0],c=t[1],s=t[2],l=0,p=[];l<u.length;l++)a=u[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(f&&f(t);p.length;)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,u=1;u<n.length;u++){var c=n[u];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={3:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var f=c;i.push([311,1]),n()}({116:function(e,t,n){(function(t){var r=n(566);function o(e,n){var o=JSON.stringify(n),i=r.utf8ToBuffer(o),a=t.crypto.getRandomValues(new Uint8Array(16));return t.crypto.subtle.encrypt({name:"AES-GCM",iv:a},e,i).then((function(e){var t=new Uint8Array(e),n=r.bufferToBase64(a);return{data:r.bufferToBase64(t),iv:n}}))}function i(e,t){var n=r.base64ToBuffer(t.data),o=r.base64ToBuffer(t.iv);return crypto.subtle.decrypt({name:"AES-GCM",iv:o},e,n).then((function(e){var t=new Uint8Array(e),n=r.bufferToUtf8(t);return JSON.parse(n)})).catch((function(e){throw new Error("Incorrect password")}))}function a(e,n){var o=r.utf8ToBuffer(e),i=r.base64ToBuffer(n);return t.crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]).then((function(e){return t.crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e4,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}))}function u(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,n=new Uint8Array(e);t.crypto.getRandomValues(n);var r=btoa(String.fromCharCode.apply(null,n));return r}e.exports={encrypt:function(e,t){var n=c();return a(e,n).then((function(e){return o(e,t)})).then((function(e){return e.salt=n,JSON.stringify(e)}))},decrypt:function(e,t){var n=JSON.parse(t),r=n.salt;return a(e,r).then((function(e){return i(e,n)}))},keyFromPassword:a,encryptWithKey:o,decryptWithKey:i,serializeBufferForStorage:function(e){for(var t="0x",n=e.length||e.byteLength,r=0;r<n;r++)t+=u(e[r]);return t},serializeBufferFromStorage:function(e){for(var t="0x"===e.slice(0,2)?e.slice(2):e,n=new Uint8Array(t.length/2),r=0;r<t.length;r+=2){var o=t.substr(r,2);n[r/2]=parseInt(o,16)}return n},generateSalt:c}}).call(this,n(13))},117:function(e,t,n){var r,o,i;o=[],void 0===(i="function"===typeof(r=function(){"use strict";return function(e,t,n){t=t||"",n=n||512;for(var r=atob(e),o=[],i=0;i<r.length;i+=n){for(var a=r.slice(i,i+n),u=new Array(a.length),c=0;c<a.length;c++)u[c]=a.charCodeAt(c);var s=new Uint8Array(u);o.push(s)}return new Blob(o,{type:t})}})?r.apply(t,o):r)||(e.exports=i)},118:function(e,t,n){(function(){function n(e){var t=null;if("string"!==typeof e)return t;var n=e.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);return n&&n.length&&(t=n[1]),t}e.exports&&(t=e.exports=n),t.base64MimeType=n}).call(this)},120:function(e,t,n){"use strict";var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r}var i=Object.keys,a=Array.isArray,u="undefined"!==typeof self?self:"undefined"!==typeof window?window:global;function c(e,t){return"object"!==typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"===typeof Promise||u.Promise||(u.Promise=Promise);var s=Object.getPrototypeOf,f={}.hasOwnProperty;function l(e,t){return f.call(e,t)}function p(e,t){"function"===typeof t&&(t=t(s(e))),i(t).forEach((function(n){h(e,n,t[n])}))}var d=Object.defineProperty;function h(e,t,n,r){d(e,t,c(n&&l(n,"get")&&"function"===typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function y(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:p.bind(null,e.prototype)}}}}var v=Object.getOwnPropertyDescriptor;function b(e,t){var n;return v(e,t)||(n=s(e))&&b(n,t)}var m=[].slice;function g(e,t,n){return m.call(e,t,n)}function w(e,t){return t(e)}function _(e){if(!e)throw new Error("Assertion Failed")}function O(e){u.setImmediate?setImmediate(e):setTimeout(e,0)}function E(e,t){return e.reduce((function(e,n,r){var o=t(n,r);return o&&(e[o[0]]=o[1]),e}),{})}function S(e,t){if(l(e,t))return e[t];if(!t)return e;if("string"!==typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=S(e,t[r]);n.push(i)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return void 0===u?void 0:S(u,t.substr(a+1))}}function A(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!==typeof t&&"length"in t){_("string"!==typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)A(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var u=t.substr(0,i),c=t.substr(i+1);if(""===c)void 0===n?a(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var s=e[u];s||(s=e[u]={}),A(s,c,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function k(e,t){"string"===typeof t?A(e,t,void 0):"length"in t&&[].map.call(t,(function(t){A(e,t,void 0)}))}function x(e){var t={};for(var n in e)l(e,n)&&(t[n]=e[n]);return t}var j=[].concat;function P(e){return j.apply([],e)}var T="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(P([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return u[e]})),I=T.map((function(e){return u[e]})),C=E(T,(function(e){return[e,!0]}));function D(e){if(!e||"object"!==typeof e)return e;var t;if(a(e)){t=[];for(var n=0,r=e.length;n<r;++n)t.push(D(e[n]))}else if(I.indexOf(e.constructor)>=0)t=e;else for(var o in t=e.constructor?Object.create(e.constructor.prototype):{},e)l(e,o)&&(t[o]=D(e[o]));return t}var R={}.toString;function N(e){return R.call(e).slice(8,-1)}var M=function e(t,n){return"Array"===n?""+t.map((function(t){return e(t,N(t))})):"ArrayBuffer"===n?""+new Uint8Array(t):"Date"===n?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function B(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((function(o){if(l(t,o)){var i=e[o],a=t[o];if("object"===typeof i&&"object"===typeof a&&i&&a){var u=N(i),c=N(a);u===c?C[u]?M(i,u)!==M(a,c)&&(n[r+o]=t[o]):B(i,a,n,r+o+"."):n[r+o]=t[o]}else i!==a&&(n[r+o]=t[o])}else n[r+o]=void 0})),i(t).forEach((function(o){l(e,o)||(n[r+o]=t[o])})),n}var K="undefined"!==typeof Symbol&&Symbol.iterator,F=K?function(e){var t;return null!=e&&(t=e[K])&&t.apply(e)}:function(){return null},U={};function L(e){var t,n,r,o;if(1===arguments.length){if(a(e))return e.slice();if(this===U&&"string"===typeof e)return[e];if(o=F(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"===typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var q="undefined"!==typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},V="undefined"!==typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function z(e,t){V=e,G=t}var G=function(){return!0},H=!new Error("").stack;function W(){if(H)try{throw new Error}catch(e){return e}return new Error}function Y(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(G).map((function(e){return"\n"+e})).join("")):""}var J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],X=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),$={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Q(e,t){this._e=W(),this.name=e,this.message=t}function Z(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function ee(e,t,n,r){this._e=W(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Z(e,t)}function te(e,t){this._e=W(),this.name="BulkError",this.failures=t,this.message=Z(e,t)}y(Q).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Y(this._e,2))}},toString:function(){return this.name+": "+this.message}}),y(ee).from(Q),y(te).from(Q);var ne=X.reduce((function(e,t){return e[t]=t+"Error",e}),{}),re=Q,oe=X.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=W(),this.name=n,e?"string"===typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"===typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=$[t]||n,this.inner=null)}return y(r).from(re),e[t]=r,e}),{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var ie=J.reduce((function(e,t){return e[t+"Error"]=oe[t],e}),{});var ae=X.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=oe[t]),e}),{});function ue(){}function ce(e){return e}function se(e,t){return null==e||e===ce?t:function(n){return t(e(n))}}function fe(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function le(e,t){return e===ue?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?fe(r,this.onsuccess):r),o&&(this.onerror=this.onerror?fe(o,this.onerror):o),void 0!==i?i:n}}function pe(e,t){return e===ue?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?fe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?fe(r,this.onerror):r)}}function de(e,t){return e===ue?t:function(n){var r=e.apply(this,arguments);c(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?fe(o,this.onsuccess):o),i&&(this.onerror=this.onerror?fe(i,this.onerror):i),void 0===r?void 0===a?void 0:a:c(r,a)}}function he(e,t){return e===ue?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ye(e,t){return e===ue?t:function(){var n=e.apply(this,arguments);if(n&&"function"===typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then((function(){return t.apply(r,i)}))}return t.apply(this,arguments)}}ae.ModifyError=ee,ae.DexieError=Q,ae.BulkError=te;var ve={},be="undefined"===typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"===typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,e]}(),me=be[0],ge=be[1],we=be[2],_e=ge&&ge.then,Oe=me&&me.constructor,Ee=!!we,Se=!1,Ae=we?function(){we.then(We)}:u.setImmediate?setImmediate.bind(null,We):u.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){We(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(We,0)},ke=function(e,t){Ne.push([e,t]),je&&(Ae(),je=!1)},xe=!0,je=!0,Pe=[],Te=[],Ie=null,Ce=ce,De={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:bt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{bt(e[0],e[1])}catch(t){}}))}},Re=De,Ne=[],Me=0,Be=[];function Ke(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ue,this._lib=!1;var t=this._PSD=Re;if(V&&(this._stackHolder=W(),this._prev=null,this._numPrev=0),"function"!==typeof e){if(e!==ve)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&qe(this,this._value))}this._state=null,this._value=null,++t.ref,Le(this,e)}var Fe={get:function(){var e=Re,t=rt;function n(n,r){var o=this,i=!e.global&&(e!==Re||t!==rt),a=i&&!ut(),u=new Ke((function(t,u){ze(o,new Ue(yt(n,e,i,a),yt(r,e,i,a),t,u,e))}));return V&&He(u,this),u}return n.prototype=ve,n},set:function(e){h(this,"then",e&&e.prototype===ve?Fe:{get:function(){return e},set:Fe.set})}};function Ue(e,t,n,r,o){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function Le(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ye();t&&"function"===typeof t.then?Le(e,(function(e,n){t instanceof Ke?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ve(e)),n&&Je()}}),qe.bind(null,e))}catch(n){qe(e,n)}}function qe(e,t){if(Te.push(t),null===e._state){var n=e._lib&&Ye();t=Ce(t),e._state=!1,e._value=t,V&&null!==t&&"object"===typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}((function(){var n=b(t,"stack");t._promise=e,h(t,"stack",{get:function(){return Se?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Pe.some((function(t){return t._value===e._value}))||Pe.push(e)}(e),Ve(e),n&&Je()}}function Ve(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ze(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===Me&&(++Me,ke((function(){0===--Me&&Xe()}),[]))}function ze(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Me,ke(Ge,[n,e,t])}else e._listeners.push(t)}function Ge(e,t,n){try{Ie=t;var r,o=t._value;t._state?r=e(o):(Te.length&&(Te=[]),r=e(o),-1===Te.indexOf(o)&&function(e){var t=Pe.length;for(;t;)if(Pe[--t]._value===e._value)return void Pe.splice(t,1)}(t)),n.resolve(r)}catch(i){n.reject(i)}finally{Ie=null,0===--Me&&Xe(),--n.psd.ref||n.psd.finalize()}}function He(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function We(){Ye()&&Je()}function Ye(){var e=xe;return xe=!1,je=!1,e}function Je(){var e,t,n;do{for(;Ne.length>0;)for(e=Ne,Ne=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ne.length>0);xe=!0,je=!0}function Xe(){var e=Pe;Pe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Be.slice(0),n=t.length;n;)t[--n]()}function $e(e){return new Ke(ve,!1,e)}function Qe(e,t){var n=Re;return function(){var r=Ye(),o=Re;try{return lt(n,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{lt(o,!1),r&&Je()}}}p(Ke.prototype,{then:Fe,_then:function(e,t){ze(this,new Ue(null,null,e,t,Re))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"===typeof t?this.then(null,(function(e){return e instanceof t?n(e):$e(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):$e(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),$e(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{Se=!0;var e=function e(t,n,r){if(n.length===r)return n;var o="";if(!1===t._state){var i,a,u=t._value;null!=u?(i=u.name||"Error",a=u.message||u,o=Y(u,0)):(i=u,a=""),n.push(i+(a?": "+a:"")+o)}V&&((o=Y(t._stackHolder,2))&&-1===n.indexOf(o)&&n.push(o),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Se=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Ke((function(r,o){var i=setTimeout((function(){return o(new oe.Timeout(t))}),e);n.then(r,o).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!==typeof Symbol&&Symbol.toStringTag&&h(Ke.prototype,Symbol.toStringTag,"Dexie.Promise"),De.env=pt(),p(Ke,{all:function(){var e=L.apply(null,arguments).map(ct);return new Ke((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(o,i){return Ke.resolve(o).then((function(n){e[i]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Ke)return e;if(e&&"function"===typeof e.then)return new Ke((function(t,n){e.then(t,n)}));var t=new Ke(ve,!0,e);return He(t,Ie),t},reject:$e,race:function(){var e=L.apply(null,arguments).map(ct);return new Ke((function(t,n){e.map((function(e){return Ke.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Re},set:function(e){return Re=e}},totalEchoes:{get:function(){return rt}},newPSD:it,usePSD:dt,scheduler:{get:function(){return ke},set:function(e){ke=e}},rejectionMapper:{get:function(){return Ce},set:function(e){Ce=e}},follow:function(e,t){return new Ke((function(n,r){return it((function(t,n){var r=Re;r.unhandleds=[],r.onunhandled=n,r.finalize=fe((function(){var e=this;!function(e){Be.push((function t(){e(),Be.splice(Be.indexOf(t),1)})),++Me,ke((function(){0===--Me&&Xe()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),Oe&&(Oe.allSettled&&h(Ke,"allSettled",(function(){var e=L.apply(null,arguments).map(ct);return new Ke((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,o){return Ke.resolve(e).then((function(e){return r[o]={status:"fulfilled",value:e}}),(function(e){return r[o]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),Oe.any&&"undefined"!==typeof AggregateError&&h(Ke,"any",(function(){var e=L.apply(null,arguments).map(ct);return new Ke((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach((function(e,i){return Ke.resolve(e).then((function(e){return t(e)}),(function(e){o[i]=e,--r||n(new AggregateError(o))}))}))}))})));var Ze={awaits:0,echoes:0,id:0},et=0,tt=[],nt=0,rt=0,ot=0;function it(e,t,n,r){var o=Re,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++ot;var a=De.env;i.env=Ee?{Promise:Ke,PromiseProp:{value:Ke,configurable:!0,writable:!0},all:Ke.all,race:Ke.race,allSettled:Ke.allSettled,any:Ke.any,resolve:Ke.resolve,reject:Ke.reject,nthen:vt(a.nthen,i),gthen:vt(a.gthen,i)}:{},t&&c(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=dt(i,e,n,r);return 0===i.ref&&i.finalize(),u}function at(){return Ze.id||(Ze.id=++et),++Ze.awaits,Ze.echoes+=100,Ze.id}function ut(){return!!Ze.awaits&&(0===--Ze.awaits&&(Ze.id=0),Ze.echoes=100*Ze.awaits,!0)}function ct(e){return Ze.echoes&&e&&e.constructor===Oe?(at(),e.then((function(e){return ut(),e}),(function(e){return ut(),mt(e)}))):e}function st(e){++rt,Ze.echoes&&0!==--Ze.echoes||(Ze.echoes=Ze.id=0),tt.push(Re),lt(e,!0)}function ft(){var e=tt[tt.length-1];tt.pop(),lt(e,!1)}function lt(e,t){var n=Re;if((t?!Ze.echoes||nt++&&e===Re:!nt||--nt&&e===Re)||ht(t?st.bind(null,e):ft),e!==Re&&(Re=e,n===De&&(De.env=pt()),Ee)){var r=De.env.Promise,o=e.env;ge.then=o.nthen,r.prototype.then=o.gthen,(n.global||e.global)&&(Object.defineProperty(u,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function pt(){var e=u.Promise;return Ee?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ge.then,gthen:e.prototype.then}:{}}function dt(e,t,n,r,o){var i=Re;try{return lt(e,!0),t(n,r,o)}finally{lt(i,!1)}}function ht(e){_e.call(me,e)}function yt(e,t,n,r){return"function"!==typeof e?e:function(){var o=Re;n&&at(),lt(t,!0);try{return e.apply(this,arguments)}finally{lt(o,!1),r&&ht(ut)}}}function vt(e,t){return function(n,r){return e.call(this,yt(n,t),yt(r,t))}}-1===(""+_e).indexOf("[native code]")&&(at=ut=ue);function bt(e,t){var n;try{n=t.onuncatched(e)}catch(i){}if(!1!==n)try{var r,o={promise:t,reason:e};if(u.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(r,o)):u.CustomEvent&&c(r=new CustomEvent("unhandledrejection",{detail:o}),o),r&&u.dispatchEvent&&(dispatchEvent(r),!u.PromiseRejectionEvent&&u.onunhandledrejection))try{u.onunhandledrejection(r)}catch(a){}V&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(i){}}var mt=Ke.reject;var gt=String.fromCharCode(65535),wt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",_t=[],Ot="undefined"!==typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Et=Ot,St=Ot,At=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function kt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var xt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function jt(e){return function(t){return void 0===S(t,e)&&k(t=D(t),e),t}}var Pt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Re.trans,o=this.name;function i(e,n,r){if(!r.schema[o])throw new oe.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}var a=Ye();try{return r&&r.db===this.db?r===Re.trans?r._promise(e,i,n):it((function(){return r._promise(e,i,n)}),{trans:r,transless:Re.transless||Re}):function e(t,n,r,o){if(t._state.openComplete||Re.letThrough){var i=t._createTransaction(n,r,t._dbSchema);try{i.create()}catch(a){return mt(a)}return i._promise(n,(function(e,t){return it((function(){return Re.trans=i,o(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return mt(new oe.DatabaseClosed);t.open().catch(ue)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,o)}))}(this.db,e,[this.name],i)}finally{a&&Je()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"===typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==gt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&V&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,o=this.db._deps.indexedDB;function u(e,t){try{return 0===o.cmp(e,t)}catch(n){return!1}}var c=t.reduce((function(t,n){var o=t[0],i=t[1],c=r[n],s=e[n];return[o||c,o||!c?kt(i,c&&c.multi?function(e){var t=S(e,n);return a(t)&&t.some((function(e){return u(s,e)}))}:function(e){return u(s,S(e,n))}):i]}),[null,null]),s=c[0],f=c[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(l(t,r))try{n[r]=t[r]}catch(o){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=jt(i)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?Ke.reject(e.failures[0]):e.lastResult})).then((function(t){if(i)try{A(e,i,t)}catch(n){}return t}))},e.prototype.update=function(e,t){if("object"!==typeof t||a(t))throw new oe.InvalidArgument("Modifications must be an object.");if("object"!==typeof e||a(e))return this.where(":id").equals(e).modify(t);i(t).forEach((function(n){A(e,n,t[n])}));var n=S(e,this.schema.primKey.keyPath);return void 0===n?mt(new oe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=jt(i)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Ke.reject(e.failures[0]):e.lastResult})).then((function(t){if(i)try{A(e,i,t)}catch(n){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ke.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:xt})})).then((function(e){return e.numFailures?Ke.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&o)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,s=u&&a?e.map(jt(u)):e;return r.core.mutate({trans:t,type:"add",keys:o,values:s,wantResults:i}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new te(r.name+".bulkAdd(): "+t+" of "+c+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&o)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,s=u&&a?e.map(jt(u)):e;return r.core.mutate({trans:t,type:"put",keys:o,values:s,wantResults:i}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new te(r.name+".bulkPut(): "+t+" of "+c+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,o=e.lastResult,i=e.failures;if(0===r)return o;throw new te(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",i)}))},e}();function Tt(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"===typeof n)return t[n]};n.addEventType=u;for(var r=1,o=arguments.length;r<o;++r)u(arguments[r]);return n;function u(e,r,o){if("object"===typeof e)return c(e);r||(r=he),o||(o=ue);var i={subscribers:[],fire:o,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=r(i.fire,e))},unsubscribe:function(e){i.subscribers=i.subscribers.filter((function(t){return t!==e})),i.fire=i.subscribers.reduce(r,o)}};return t[e]=n[e]=i,i}function c(e){i(e).forEach((function(t){var n=e[t];if(a(n))u(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new oe.InvalidArgument("Invalid event config");var r=u(t,ce,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){O((function(){e.apply(null,t)}))}))}))}}))}}function It(e,t){return y(t).from({prototype:e}),t}function Ct(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Dt(e,t){e.filter=kt(e.filter,t)}function Rt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return kt(r(),t())}:t,e.justLimit=n&&!r}function Nt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new oe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Mt(e,t,n){var r=Nt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Bt(e,t,n,r){var o=e.replayFilter?kt(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},a=function(e,n,r){if(!o||o(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),l(i,u)||(i[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Kt(Mt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Kt(Mt(e,r,n),kt(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function Kt(e,t,n,r){var o=Qe(r?function(e,t,o){return n(r(e),t,o)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ue}),(function(t){e.fail(t),n=ue}))||o(e.value,e,(function(e){return n=e})),n()}))}))}var Ft=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=kt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Bt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Bt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Ct(n,!0))return r.count({trans:e,query:{index:Nt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var o=0;return Bt(n,(function(){return++o,!1}),e,r).then((function(){return o}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=i(e,o),r=i(t,o);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Ct(n,!0)&&n.limit>0){var r=n.valueMapper,o=Nt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var i=[];return Bt(n,(function(e){return i.push(e)}),e,n.table.core).then((function(){return i}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ct(t)?Rt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Rt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Rt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return Dt(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return Dt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=kt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Ct(t,!0)&&t.limit>0)return this._read((function(e){var n=Nt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Dt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=l(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var o;if("function"===typeof e)o=e;else{var a=i(e),u=a.length;o=function(t){for(var n=!1,r=0;r<u;++r){var o=a[r],i=e[o];S(t,o)!==i&&(A(t,o,i),n=!0)}return n}}var c=n.table.core,s=c.schema.primaryKey,f=s.outbound,l=s.extractKey,p="testmode"in In?1:2e3,d=t.db.core.cmp,h=[],y=0,v=[],b=function(e,t){var n=t.failures,r=t.numFailures;y+=e-r;for(var o=0,a=i(n);o<a.length;o++){var u=a[o];h.push(n[u])}};return t.clone().primaryKeys().then((function(e){return function t(n){var i=Math.min(p,e.length-n);return c.getMany({trans:r,keys:e.slice(n,n+i)}).then((function(a){for(var u=[],s=[],h=f?[]:null,y=[],v=0;v<i;++v){var m=a[v],g={value:D(m),primKey:e[n+v]};!1!==o.call(g,g.value,g)&&(null==g.value?y.push(e[n+v]):f||0===d(l(m),l(g.value))?(s.push(g.value),f&&h.push(e[n+v])):(y.push(e[n+v]),u.push(g.value)))}return Promise.resolve(u.length>0&&c.mutate({trans:r,type:"add",values:u}).then((function(e){for(var t in e.failures)y.splice(parseInt(t),1);b(u.length,e)}))).then((function(e){return s.length>0&&c.mutate({trans:r,type:"put",keys:h,values:s}).then((function(e){return b(s.length,e)}))})).then((function(){return y.length>0&&c.mutate({trans:r,type:"delete",keys:y}).then((function(e){return b(y.length,e)}))})).then((function(){return e.length>n+i&&t(n+p)}))}))}(0).then((function(){if(h.length>0)throw new ee("Error modifying one or more objects",h,y,v);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Ct(e)&&(e.isPrimKey&&!St||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((function(e){var n=e.failures,r=(e.lastResult,e.results,e.numFailures);if(r)throw new ee("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify((function(e,t){return t.value=null}))},e}();function Ut(e,t){return e<t?-1:e===t?0:1}function Lt(e,t){return e>t?-1:e===t?0:1}function qt(e,t,n){var r=e instanceof Yt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Vt(e){return new e.Collection(e,(function(){return Wt("")})).limit(0)}function zt(e,t,n,r,o,i){for(var a=Math.min(e.length,r.length),u=-1,c=0;c<a;++c){var s=t[c];if(s!==r[c])return o(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):o(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;o(e[c],s)<0&&(u=c)}return a<r.length&&"next"===i?e+n.substr(e.length):a<e.length&&"prev"===i?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function Gt(e,t,n,r){var o,i,a,u,c,s,f,l=n.length;if(!n.every((function(e){return"string"===typeof e})))return qt(e,"String expected.");function p(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),i=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Ut:Lt;var t=n.map((function(e){return{lower:i(e),upper:o(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));u=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),s=e,f="next"===e?"":r}p("next");var d=new e.Collection(e,(function(){return Ht(u[0],c[l-1]+r)}));d._ondirectionchange=function(e){p(e)};var h=0;return d._addAlgorithm((function(e,n,r){var o=e.key;if("string"!==typeof o)return!1;var p=i(o);if(t(p,c,h))return!0;for(var d=null,y=h;y<l;++y){var v=zt(o,p,u[y],c[y],a,s);null===v&&null===d?h=y+1:(null===d||a(d,v)>0)&&(d=v)}return n(null!==d?function(){e.continue(d+f)}:r),!1})),d}function Ht(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Wt(e){return{type:1,lower:e,upper:e}}var Yt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Vt(this):new this.Collection(this,(function(){return Ht(e,t,!n,!r)}))}catch(o){return qt(this,wt)}},e.prototype.equals=function(e){return null==e?qt(this,wt):new this.Collection(this,(function(){return Wt(e)}))},e.prototype.above=function(e){return null==e?qt(this,wt):new this.Collection(this,(function(){return Ht(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?qt(this,wt):new this.Collection(this,(function(){return Ht(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?qt(this,wt):new this.Collection(this,(function(){return Ht(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?qt(this,wt):new this.Collection(this,(function(){return Ht(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!==typeof e?qt(this,"String expected."):this.between(e,e+gt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Gt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],gt)},e.prototype.equalsIgnoreCase=function(e){return Gt(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=L.apply(U,arguments);return 0===e.length?Vt(this):Gt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=L.apply(U,arguments);return 0===e.length?Vt(this):Gt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,gt)},e.prototype.anyOf=function(){var e=this,t=L.apply(U,arguments),n=this._cmp;try{t.sort(n)}catch(i){return qt(this,wt)}if(0===t.length)return Vt(this);var r=new this.Collection(this,(function(){return Ht(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm((function(e,r,i){for(var a=e.key;n(a,t[o])>0;)if(++o===t.length)return r(i),!1;return 0===n(a,t[o])||(r((function(){e.continue(t[o])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=L.apply(U,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(n){return qt(this,wt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,o=this._ascending,i=this._descending,a=this._min,u=this._max;if(0===e.length)return Vt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return qt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);var c=!t||!1!==t.includeLowers,s=t&&!0===t.includeUppers;var f,l=o;function p(e,t){return l(e[0],t[0])}try{(f=e.reduce((function(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=u(i[1],t[1]);break}}return n===o&&e.push(t),e}),[])).sort(p)}catch(m){return qt(this,wt)}var d=0,h=s?function(e){return o(e,f[d][1])>0}:function(e){return o(e,f[d][1])>=0},y=c?function(e){return i(e,f[d][0])>0}:function(e){return i(e,f[d][0])>=0};var v=h,b=new this.Collection(this,(function(){return Ht(f[0][0],f[f.length-1][1],!c,!s)}));return b._ondirectionchange=function(e){"next"===e?(v=h,l=o):(v=y,l=i),f.sort(p)},b._addAlgorithm((function(e,t,r){for(var i=e.key;v(i);)if(++d===f.length)return t(r),!1;return!!function(e){return!h(e)&&!y(e)}(i)||(0===n._cmp(i,f[d][1])||0===n._cmp(i,f[d][0])||t((function(){l===o?e.continue(f[d][0]):e.continue(f[d][1])})),!1)})),b},e.prototype.startsWithAnyOf=function(){var e=L.apply(U,arguments);return e.every((function(e){return"string"===typeof e}))?0===e.length?Vt(this):this.inAnyRange(e.map((function(e){return[e,e+gt]}))):qt(this,"startsWithAnyOf() only works with strings")},e}();function Jt(e){return 1===e.length?e[0]:e}function Xt(e){try{return e.only([[]]),[[]]}catch(t){return gt}}function $t(e){return Qe((function(t){return Qt(t),e(t.target.error),!1}))}function Qt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Zt=function(){function e(){}return e.prototype._lock=function(){return _(!Re.global),++this._reculock,1!==this._reculock||Re.global||(Re.lockOwnerFor=this),this},e.prototype._unlock=function(){if(_(!Re.global),0===--this._reculock)for(Re.global||(Re.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{dt(e[1],e[0])}catch(t){}}return this},e.prototype._locked=function(){return this._reculock&&Re.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(_(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(r);case"MissingAPIError":throw new oe.MissingAPI(r.message,r);default:throw new oe.OpenFailed(r)}if(!this.active)throw new oe.TransactionInactive;return _(null===this._completion._state),(e=this.idbtrans=e||n.transaction(Jt(this.storeNames),this.mode)).onerror=Qe((function(n){Qt(n),t._reject(e.error)})),e.onabort=Qe((function(n){Qt(n),t.active&&t._reject(new oe.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Qe((function(){t.active=!1,t._resolve()})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new oe.TransactionInactive);if(this._locked())return new Ke((function(o,i){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,i)},Re])}));if(n)return it((function(){var e=new Ke((function(e,n){r._lock();var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var o=new Ke((function(e,n){var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Ke.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new Ke((function(e,r){n.then((function(n){return t._waitingQueue.push(Qe(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Qe(r.bind(null,e)))})).finally((function(){t._waitingFor===o&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new oe.Abort),this.active=!1},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new oe.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function en(e,t,n,r,o,i,a){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+tn(t)}}function tn(e){return"string"===typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function nn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:E(n,(function(e){return[e.name,e]}))}}function rn(e){return null==e?function(){}:"string"===typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return S(t,e)}}(e):function(t){return S(t,e)}}function on(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}function an(e){return[].slice.call(e)}var un=0;function cn(e){return null==e?":id":"string"===typeof e?e:"["+e.join("+")+"]"}function sn(e,t,n,r){var i=t.cmp.bind(t);function u(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,o=e.lowerOpen,i=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!i):void 0===r?n.lowerBound(t,!!o):n.bound(t,r,!!o,!!i)}var c=function(e,t){var n=an(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),o=null==t,i={},u={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:rn(t)},indexes:an(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,u={name:t,compound:a(o),keyPath:o,unique:n,multiEntry:r,extractKey:rn(o)};return i[cn(o)]=u,u})),getIndexByKeyPath:function(e){return i[cn(e)]}};return i[":id"]=u.primaryKey,null!=t&&(i[cn(t)]=u.primaryKey),u}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=c.schema,f=c.hasGetAll,l=s.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(n){var r=n.trans,i=n.type,a=n.keys,c=n.values,s=n.range,f=n.wantResults;return new Promise((function(n,l){n=Qe(n);var p=r.objectStore(t),d=null==p.keyPath,h="put"===i||"add"===i;if(!h&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var y=(a||c||{length:1}).length;if(a&&c&&a.length!==c.length)throw new Error("Given keys array must have same length as given values array.");if(0===y)return n({numFailures:0,failures:{},results:[],lastResult:void 0});var v,b=f&&o(a||on(e.primaryKey,{type:i,keys:a,values:c})),m=[],g=0,w=function(e){++g,Qt(e),b&&(b[e.target._reqno]=void 0),m[e.target._reqno]=e.target.error},_=function(e){var t=e.target;b[t._reqno]=t.result};if("deleteRange"===i){if(4===s.type)return n({numFailures:g,failures:m,results:b,lastResult:void 0});v=3===s.type?p.clear():p.delete(u(s))}else{var O=h?d?[c,a]:[c,null]:[a,null],E=O[0],S=O[1];if(h)for(var A=0;A<y;++A)(v=S&&void 0!==S[A]?p[i](E[A],S[A]):p[i](E[A]))._reqno=A,b&&void 0===b[A]&&(v.onsuccess=_),v.onerror=w;else for(A=0;A<y;++A)(v=p[i](E[A]))._reqno=A,v.onerror=w}var k=function(e){var t=e.target.result;b&&(b[y-1]=t),n({numFailures:g,failures:m,results:b,lastResult:t})};v.onerror=function(e){w(e),k(e)},v.onsuccess=k}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,o){e=Qe(e);for(var i,a=n.objectStore(t),u=r.length,c=new Array(u),s=0,f=0,l=function(t){var n=t.target;null!=(c[n._pos]=n.result)&&0,++f===s&&e(c)},p=$t(o),d=0;d<u;++d){null!=r[d]&&((i=a.get(r[d]))._pos=d,i.onsuccess=l,i.onerror=p,++s)}0===s&&e(c)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,o){e=Qe(e);var i=n.objectStore(t).get(r);i.onsuccess=function(t){return e(t.target.result)},i.onerror=$t(o)}))},query:function(e){return function(n){return new Promise((function(r,o){r=Qe(r);var i=n.trans,a=n.values,c=n.limit,s=n.query,f=c===1/0?void 0:c,l=s.index,p=s.range,d=i.objectStore(t),h=l.isPrimaryKey?d:d.index(l.name),y=u(p);if(0===c)return r({result:[]});if(e){var v=a?h.getAll(y,f):h.getAllKeys(y,f);v.onsuccess=function(e){return r({result:e.target.result})},v.onerror=$t(o)}else{var b=0,m=a||!("openKeyCursor"in h)?h.openCursor(y):h.openKeyCursor(y),g=[];m.onsuccess=function(e){var t=m.result;return t?(g.push(a?t.value:t.primaryKey),++b===c?r({result:g}):void t.continue()):r({result:g})},m.onerror=$t(o)}}))}}(f),openCursor:function(e){var n=e.trans,r=e.values,o=e.query,i=e.reverse,a=e.unique;return new Promise((function(e,c){e=Qe(e);var s=o.index,f=o.range,l=n.objectStore(t),p=s.isPrimaryKey?l:l.index(s.name),d=i?a?"prevunique":"prev":a?"nextunique":"next",h=r||!("openKeyCursor"in p)?p.openCursor(u(f),d):p.openKeyCursor(u(f),d);h.onerror=$t(c),h.onsuccess=Qe((function(t){var r=h.result;if(r){r.___id=++un,r.done=!1;var o=r.continue.bind(r),i=r.continuePrimaryKey;i&&(i=i.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Qe(c),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Qe(e),h.onerror=$t(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,e(t)}})),n=function(){if(h.result)try{e()}catch(t){r.fail(t)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return h.onsuccess=Qe((function(e){h.onsuccess=n,n()})),r.continue=o,r.continuePrimaryKey=i,r.advance=a,n(),t},e(r)}else e(null)}),c)}))},count:function(e){var n=e.query,r=e.trans,o=n.index,i=n.range;return new Promise((function(e,n){var a=r.objectStore(t),c=o.isPrimaryKey?a:a.index(o.name),s=u(i),f=s?c.count(s):c.count();f.onsuccess=Qe((function(t){return e(t.target.result)})),f.onerror=$t(n)}))}}}(e)})),p={};return l.forEach((function(e){return p[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!p[e])throw new Error("Table '"+e+"' not found");return p[e]},cmp:i,MIN_KEY:-1/0,MAX_KEY:Xt(n),schema:s}}function fn(e,t,n,o){var i=n.IDBKeyRange;return{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(sn(t,n.indexedDB,i,o),e.dbcore)}}function ln(e,t){var n=t.db,r=fn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function pn(e,t,n,r){n.forEach((function(n){var o=r[n];t.forEach((function(t){var r=b(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get:function(){return this.table(n)},set:function(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function dn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function hn(e,t){return e._cfg.version-t._cfg.version}function yn(e,t,n,r){var o=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,o);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),c=Re.transless||Re;it((function(){Re.trans=a,Re.transless=c,0===t?(i(o).forEach((function(e){bn(n,e,o[e].primKey,o[e].indexes)})),ln(e,n),Ke.follow((function(){return e.on.populate.fire(a)})).catch(u)):function(e,t,n,r){var o=[],a=e._versions,u=e._dbSchema=gn(e,e.idbdb,r),c=!1;function s(){return o.length?Ke.resolve(o.shift()(n.idbtrans)).then(s):Ke.resolve()}return a.filter((function(e){return e._cfg.version>=t})).forEach((function(a){o.push((function(){var o=u,s=a._cfg.dbschema;wn(e,o,r),wn(e,s,r),u=e._dbSchema=s;var f=vn(o,s);f.add.forEach((function(e){bn(r,e[0],e[1].primKey,e[1].indexes)})),f.change.forEach((function(e){if(e.recreate)throw new oe.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return mn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),mn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=a._cfg.contentUpgrade;if(l&&a._cfg.version>t){ln(e,r),n._memoizedTables={},c=!0;var p=x(s);f.del.forEach((function(e){p[e]=o[e]})),dn(e,[e.Transaction.prototype]),pn(e,[e.Transaction.prototype],i(p),p),n.schema=p;var d,h=q(l);h&&at();var y=Ke.follow((function(){if((d=l(n))&&h){var e=ut.bind(null,null);d.then(e,e)}}));return d&&"function"===typeof d.then?Ke.resolve(d):y.then((function(){return d}))}})),o.push((function(t){c&&Et||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(a._cfg.dbschema,t);dn(e,[e.Transaction.prototype]),pn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),s().then((function(){var e,t;t=r,i(e=u).forEach((function(n){t.db.objectStoreNames.contains(n)||bn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,a,n).catch(u)}))}function vn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],i=t[n];if(o){var a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!==""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto&&!Ot)a.recreate=!0,r.change.push(a);else{var u=o.idxByName,c=i.idxByName,s=void 0;for(s in u)c[s]||a.del.push(s);for(s in c){var f=u[s],l=c[s];f?f.src!==l.src&&a.change.push(l):a.add.push(l)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,i])}return r}function bn(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return mn(o,e)})),o}function mn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function gn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),o=t.keyPath,i=en(tn(o),o||"",!1,!1,!!t.autoIncrement,o&&"string"!==typeof o,!0),a=[],u=0;u<t.indexNames.length;++u){var c=t.index(t.indexNames[u]);o=c.keyPath;var s=en(c.name,o,!!c.unique,!!c.multiEntry,!1,o&&"string"!==typeof o,!1);a.push(s)}r[e]=nn(e,i,a)})),r}function wn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var i=r[o],a=n.objectStore(i);e._hasGetAll="getAll"in a;for(var c=0;c<a.indexNames.length;++c){var s=a.indexNames[c],f=a.index(s).keyPath,l="string"===typeof f?f:"["+g(f).join("+")+"]";if(t[i]){var p=t[i].idxByName[l];p&&(p.name=s,delete t[i].idxByName[l],t[i].idxByName[s]=p)}}}"undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var _n,On=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){i(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return en(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)})),o=r.shift();if(o.multi)throw new oe.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")})),t[n]=nn(n,o,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},o={};return n.forEach((function(e){c(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,dn(t,[t._allTables,t,t.Transaction.prototype]),pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function En(e){return it((function(){return Re.letThrough=!0,e()}))}function Sn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?mt(t.dbOpenError):e}));V&&(t.openCanceller._stackHolder=W()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,o=null;return Ke.race([t.openCanceller,new Ke((function(r,a){if(!n)throw new oe.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var u=e.name,c=t.autoSchema?n.open(u):n.open(u,Math.round(10*e.verno));if(!c)throw new oe.MissingAPI("IndexedDB API not available");c.onerror=$t(a),c.onblocked=Qe(e._fireOnBlocked),c.onupgradeneeded=Qe((function(r){if(o=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Qt,o.abort(),c.result.close();var i=n.deleteDatabase(u);i.onsuccess=i.onerror=Qe((function(){a(new oe.NoSuchDatabase("Database "+u+" doesnt exist"))}))}else{o.onerror=$t(a);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=c.result,yn(e,s/10,o,a)}}),a),c.onsuccess=Qe((function(){o=null;var n=e.idbdb=c.result,a=g(n.objectStoreNames);if(a.length>0)try{var s=n.transaction(Jt(a),"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=gn(0,t,n);e._storeNames=g(t.objectStoreNames,0),pn(e,[e._allTables],i(r),r)}(e,n,s):(wn(e,e._dbSchema,s),function(e,t){var n=vn(gn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,s)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ln(e,s)}catch(f){}_t.push(e),n.onversionchange=Qe((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),_n.add(u),r()}),a)}))]).then((function(){return t.onReadyBeingFired=[],Ke.resolve(En(e.on.ready.fire)).then((function e(){if(t.onReadyBeingFired.length>0){var n=t.onReadyBeingFired.reduce(ye,ue);return t.onReadyBeingFired=[],Ke.resolve(En(n)).then(e)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,e})).catch((function(n){try{o&&o.abort()}catch(r){}return t.isBeingOpened=!1,e.close(),t.dbOpenError=n,mt(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function An(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),i=o.value;return o.done?i:i&&"function"===typeof i.then?i.then(n,r):a(i)?Promise.all(i).then(n,r):n(i)}}return o(t)()}function kn(e,t,n){var r=arguments.length;if(r<2)throw new oe.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];n=o.pop();var i=P(o);return[e,i,n]}function xn(e,t,n,r,o){return Ke.resolve().then((function(){var i=Re.transless||Re,a=e._createTransaction(t,n,e._dbSchema,r),u={trans:a,transless:i};r?a.idbtrans=r.idbtrans:a.create();var c,s=q(o);s&&at();var f=Ke.follow((function(){if(c=o.call(a,a))if(s){var e=ut.bind(null,null);c.then(e,e)}else"function"===typeof c.next&&"function"===typeof c.throw&&(c=An(c))}),u);return(c&&"function"===typeof c.then?Ke.resolve(c).then((function(e){return a.active?e:mt(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):f.then((function(){return c}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),mt(e)}))}))}function jn(e,t,n){for(var r=a(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Pn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema,i={},a=[];function u(e,t,n){var o=cn(e),c=i[o]=i[o]||[],s=null==e?0:"string"===typeof e?1:e.length,f=t>0,l=r(r({},n),{isVirtual:f,isPrimaryKey:!f&&n.isPrimaryKey,keyTail:t,keyLength:s,extractKey:rn(e),unique:!f&&n.unique});(c.push(l),l.isPrimaryKey||a.push(l),s>1)&&u(2===s?e[0]:e.slice(0,s-1),t+1,n);return c.sort((function(e,t){return e.keyTail-t.keyTail})),l}var c=u(o.primaryKey.keyPath,0,o.primaryKey);i[":id"]=[c];for(var s=0,f=o.indexes;s<f.length;s++){var l=f[s];u(l.keyPath,0,l)}function p(t){var n,o,i=t.query.index;return i.isVirtual?r(r({},t),{query:{index:i,range:(n=t.query.range,o=i.keyTail,{type:1===n.type?2:n.type,lower:jn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:jn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},o),{primaryKey:c,indexes:a,getIndexByKeyPath:function(e){var t=i[cn(e)];return t&&t[0]}}),count:function(e){return n.count(p(e))},query:function(e){return n.query(p(e))},openCursor:function(t){var r=t.query.index,o=r.keyTail,i=r.isVirtual,a=r.keyLength;if(!i)return n.openCursor(t);return n.openCursor(p(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(jn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(jn(n.key,t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(jn(t,e.MAX_KEY,o),r)}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}(n)}))}})}})}},Tn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey;return r(r({},n),{mutate:function(e){var a=Re.trans,u=a.table(t).hook,c=u.deleting,s=u.creating,f=u.updating;switch(e.type){case"add":if(s.fire===ue)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"put":if(s.fire===ue&&f.fire===ue)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"delete":if(c.fire===ue)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"deleteRange":if(c.fire===ue)break;return a._promise("readwrite",(function(){return function(e){return function e(t,o,a){return n.query({trans:t,values:!1,query:{index:i,range:o},limit:a}).then((function(n){var i=n.result;return p({type:"delete",keys:i,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):i.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},o),{lower:i[i.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function p(e){var t=Re.trans,a=e.keys||on(i,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:a,wantResults:!0}):r({},e)).type&&(e.values=o(e.values)),e.keys&&(e.keys=o(e.keys)),function(e,t,n){return"add"===t.type?Promise.resolve(new Array(t.values.length)):e.getMany({trans:t.trans,keys:n})}(n,e,a).then((function(r){var o=a.map((function(n,o){var a=r[o],u={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(u,n,a,t);else if("add"===e.type||void 0===a){var p=s.fire.call(u,n,e.values[o],t);null==n&&null!=p&&(n=p,e.keys[o]=n,i.outbound||A(e.values[o],i.keyPath,n))}else{var d=B(a,e.values[o]),h=f.fire.call(u,d,n,a,t);if(h){var y=e.values[o];Object.keys(h).forEach((function(e){l(y,e)?y[e]=h[e]:A(y,e,h[e])}))}}return u}));return n.mutate(e).then((function(t){for(var n=t.failures,i=t.results,u=t.numFailures,c=t.lastResult,s=0;s<a.length;++s){var f=i?i[s]:a[s],l=o[s];null==f?l.onerror&&l.onerror(n[s]):l.onsuccess&&l.onsuccess("put"===e.type&&r[s]?e.values[s]:f)}return{failures:n,results:i,numFailures:u,lastResult:c}})).catch((function(e){return o.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}},In=function(){function e(t,n){var o=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var u,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ue,dbReadyPromise:null,cancelOpen:ue,openCanceller:null,autoSchema:!0};c.dbReadyPromise=new Ke((function(e){c.dbReadyResolve=e})),c.openCanceller=new Ke((function(e,t){c.cancelOpen=t})),this._state=c,this.name=t,this.on=Tt(this,"populate","blocked","versionchange",{ready:[ye,ue]}),this.on.ready.subscribe=w(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=o._state;if(e.openComplete)e.dbOpenError||Ke.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var i=o;r||t((function e(){i.on.ready.unsubscribe(n),i.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(u=this,It(Ft.prototype,(function(e,t){this.db=u;var n=xt,r=null;if(t)try{n=t()}catch(c){r=c}var o=e._ctx,i=o.table,a=i.hook.reading.fire;this._ctx={table:i,index:o.index,isPrimKey:!o.index||i.schema.primKey.keyPath&&o.index===i.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:a!==ce?a:null}}))),this.Table=function(e){return It(Pt.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Tt(null,{creating:[le,ue],reading:[se,ce],updating:[de,ue],deleting:[pe,ue]})}))}(this),this.Transaction=function(e){return It(Zt.prototype,(function(t,n,r,o){var i=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=Tt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ke((function(e,t){i._resolve=e,i._reject=t})),this._completion.then((function(){i.active=!1,i.on.complete.fire()}),(function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),mt(e)}))}))}(this),this.Version=function(e){return It(On.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return It(Yt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var o=e._deps.indexedDB;if(!o)throw new oe.MissingAPI("indexedDB API missing");this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(e,t){return o.cmp(t,e)},this._max=function(e,t){return o.cmp(e,t)>0?e:t},this._min=function(e,t){return o.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+o.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+o.name+"'. Closing db now to resume the delete request."),o.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+o.name+"') was blocked"):console.warn("Upgrade '"+o.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=Xt(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,r)},this._fireOnBlocked=function(e){o.on("blocked").fire(e),_t.filter((function(e){return e.name===o.name&&e!==o&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Pn),this.use(Tn),a.forEach((function(e){return e(o)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new oe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(hn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this._state.openComplete||Re.letThrough?e():new Ke((function(e,n){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new oe.DatabaseClosed);t.open().catch(ue)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;o&&this.unuse({stack:t,name:o});var i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:n,level:null==r?10:r,name:o}),i.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return Sn(this)},e.prototype.close=function(){var e=_t.indexOf(this),t=this._state;if(e>=0&&_t.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new oe.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Ke((function(e){t.dbReadyResolve=e})),t.openCanceller=new Ke((function(e,n){t.cancelOpen=n}))},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Ke((function(r,o){var i=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Qe((function(){_n.remove(e.name),r()})),t.onerror=$t(o),t.onblocked=e._fireOnBlocked};if(t)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return i(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=kn.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,o=Re.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var i,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!==typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)i="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new oe.InvalidArgument("Invalid transaction mode: "+e);i="readwrite"}if(o){if("readonly"===o.mode&&"readwrite"===i){if(!u)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!u)throw new oe.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),u&&o&&!o.active&&(o=null)}}catch(s){return o?o._promise(null,(function(e,t){t(s)})):mt(s)}var c=xn.bind(null,this,i,a,o,n);return o?o._promise(i,c,"lock"):Re.trans?dt(Re.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},e.prototype.table=function(e){if(!l(this._allTables,e))throw new oe.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Cn=In;p(Cn,r(r({},ae),{delete:function(e){return new Cn(e).delete()},exists:function(e){return new Cn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return _n?_n.getDatabaseNames().then(e):Ke.resolve([])},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return Re.trans?dt(Re.transless,e):e()},vip:En,async:function(e){return function(){try{var t=An(e.apply(this,arguments));return t&&"function"===typeof t.then?t:Ke.resolve(t)}catch(n){return mt(n)}}},spawn:function(e,t,n){try{var r=An(e.apply(n,t||[]));return r&&"function"===typeof r.then?r:Ke.resolve(r)}catch(o){return mt(o)}},currentTransaction:{get:function(){return Re.trans||null}},waitFor:function(e,t){var n=Ke.resolve("function"===typeof e?Cn.ignoreTransaction(e):e).timeout(t||6e4);return Re.trans?Re.trans.waitFor(n):n},Promise:Ke,debug:{get:function(){return V},set:function(e){z(e,"dexie"===e?function(){return!0}:At)}},derive:y,extend:c,props:p,override:w,Events:Tt,getByKeyPath:S,setByKeyPath:A,delByKeyPath:k,shallowClone:x,deepClone:D,getObjectDiff:B,asap:O,minKey:-1/0,addons:[],connections:_t,errnames:ne,dependencies:function(){try{return{indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.3",version:"3.0.3".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Cn,Dexie:Cn})),Cn.maxKey=Xt(Cn.dependencies.IDBKeyRange),function(e){try{_n=function(e){var t,n=e&&"function"===typeof e.databases;if(!n){var r=new In("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return n?Ke.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):t.toCollection().primaryKeys()},add:function(e){return!n&&"__dbnames"!==e&&t.put({name:e}).catch(ue)},remove:function(e){return!n&&"__dbnames"!==e&&t.delete(e).catch(ue)}}}(e)}catch(t){}}(In.dependencies.indexedDB),Ke.rejectionMapper=function(e,t){if(!e||e instanceof Q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ie[e.name])return e;var n=new ie[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},z(V,At),t.a=In},15:function(e,t,n){"use strict";var r={$loaded:Promise.resolve(),clientsMeta:[],globalSettings:{muted:[]},chatSettings:{},notifications:!1,audioNotifications:!0},o=localStorage.getItem("dchat");o&&(o=JSON.parse(o),r.clientsMeta=o?[o]:[]);var i,a=localStorage.getItem("dchatv2");a&&((r=JSON.parse(a)).$loaded=Promise.resolve()),i=Proxy?new Proxy(r,{set:function(e,t,n){return"$loaded"!==t&&(e[t]=n,localStorage.setItem("dchatv2",JSON.stringify(e))),!0}}):r,t.a=i},174:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(32),o=n.n(r),i=n(7),a=n.n(i),u=n(15);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return e.map((function(e){return s(s({},e),{},{active:!1})}))}function l(e){return e.find((function(e){return e.active}))}t.b=function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"nkn/DEACTIVATE_CLIENTS":e=f(i);break;case"nkn/ACTIVATE_CLIENT":n=a.payload.client.wallet.Address,-1===(r=(e=f(i)).findIndex((function(e){return e.wallet.Address===n})))?(t=s(s({},a.payload.client),{},{createdAt:Date.now(),active:!0}),e=[].concat(o()(e),[t])):e[r]=s(s(s({},e[r]),a.payload.client),{},{active:!0}),u.a.clientsMeta=e;break;case"nkn/SET_BALANCE":n=a.payload.address,e=i.map((function(e){var t=s({},e);return t.wallet.Address===n&&(t.balance=a.payload.balance),t})),u.a.clientsMeta=e;break;default:e=i}return e}},175:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return y}));var r=n(9),o=n.n(r),i=n(3),a=n.n(i),u=n(81),c=n.n(u),s=n(20),f=n(117),l=n.n(f),p=n(118),d=n.n(p);function h(e){var t=c()(e),n=d()(e);return e=e.slice(e.indexOf(",")+1),e=l()(e,n),s.a.attachments.add({hash:t,data:e}).catch((function(){})),t}function y(e){return v.apply(this,arguments)}function v(){return(v=o()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.attachments.get({hash:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},176:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"a",(function(){return i}))},183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"applyMiddleware",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"wrapStore",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"alias",{enumerable:!0,get:function(){return a.default}});var r=u(n(320)),o=u(n(323)),i=u(n(324)),a=u(n(326));function u(e){return e&&e.__esModule?e:{default:e}}},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PORT_NAME=t.PATCH_STATE_TYPE=t.STATE_TYPE=t.DISPATCH_TYPE=void 0;t.DISPATCH_TYPE="chromex.dispatch";t.STATE_TYPE="chromex.state";t.PATCH_STATE_TYPE="chromex.patch_state";t.DEFAULT_PORT_NAME="chromex.port_name"},185:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.withSerializer=t.withDeserializer=t.noop=void 0;var i=function(e){return e};t.noop=i;var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return r({},e,e.payload?{payload:t(e.payload)}:{})},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=arguments.length>2?arguments[2]:void 0;return n?function(r){for(var o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];return n.apply(void 0,[r].concat(i))?e.apply(void 0,[a(r,t)].concat(i)):e.apply(void 0,[r].concat(i))}:function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return e.apply(void 0,[a(n,t)].concat(o))}};t.withDeserializer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return function(t){return function(n,r){return t(u(n,e,r))}}};t.withSerializer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];if(o.length<=n)throw new Error("Message in request could not be serialized. "+"Expected message in position ".concat(n," but only received ").concat(o.length," args."));return o[n]=a(o[n],e),t.apply(void 0,o)}}}},186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DIFF_STATUS_ARRAY_UPDATED=t.DIFF_STATUS_KEYS_UPDATED=t.DIFF_STATUS_REMOVED=t.DIFF_STATUS_UPDATED=void 0;t.DIFF_STATUS_UPDATED="updated";t.DIFF_STATUS_REMOVED="removed";t.DIFF_STATUS_KEYS_UPDATED="updated_keys";t.DIFF_STATUS_ARRAY_UPDATED="updated_array"},187:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserAPI=function(){var e;try{e=self.chrome||self.browser||browser}catch(t){e=browser}if(!e)throw new Error("Browser API is not present");return e}},20:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(120),o=new r.a("dchat");o.version(1).stores({attachments:"++id,&hash"}),o.version(2).stores({messages:"[topic+id+addr], [topic+createdAt], createdAt",reactions:"[topic+id+addr], [topic+targetID]"}),o.version(3).stores({contacts:"addr"});var i=r.a.maxKey,a=r.a.minKey;t.a=o},301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=new Audio("img/when.ogg");r.volume=.2;var o=function(){r.play()}},302:function(e,t,n){"use strict";var r=n(80).compose;t.__esModule=!0,t.composeWithDevTools="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}},303:function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"===typeof o?o(n,r,e):t(o)}}}}var o=r();o.withExtraArgument=r,t.a=o},304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){if(!e)throw new Error("`createWorkerMiddleware` expects a worker instance as the argument. Instead received: "+e);if(!e.postMessage)throw new Error("The worker instance is expected to have a `postMessage` method.");return function(t){var n=t.dispatch;return e.onmessage=function(e){var t=e.data;n(t)},function(t){if(!t)throw new Error("Worker middleware received no `next` action. Check your chain of middlewares.");return function(n){return n.meta&&n.meta.WebWorker&&e.postMessage(n),t(n)}}}}},305:function(e,t,n){"use strict";var r;!function(o){if("function"!==typeof i){var i=function(e){return e};i.nonNative=!0}var a=i("plaintext"),u=i("html"),c=i("comment"),s=/<(\w*)>/g,f=/<\/?([^\s\/>]+)/;function l(e,t,n){return d(e=e||"",p(t=t||[],n=n||""))}function p(e,t){return{allowable_tags:e=function(e){var t,n=new Set;if("string"===typeof e)for(;t=s.exec(e);)n.add(t[1]);else i.nonNative||"function"!==typeof e[i.iterator]?"function"===typeof e.forEach&&e.forEach(n.add,n):n=new Set(e);return n}(e),tag_replacement:t,state:a,tag_buffer:"",depth:0,in_quote_char:""}}function d(e,t){if("string"!=typeof e)throw new TypeError("'html' parameter must be a string");for(var n=t.allowable_tags,r=t.tag_replacement,o=t.state,i=t.tag_buffer,s=t.depth,f=t.in_quote_char,l="",p=0,d=e.length;p<d;p++){var y=e[p];if(o===a)switch(y){case"<":o=u,i+=y;break;default:l+=y}else if(o===u)switch(y){case"<":if(f)break;s++;break;case">":if(f)break;if(s){s--;break}f="",o=a,i+=">",n.has(h(i))?l+=i:l+=r,i="";break;case'"':case"'":f=y===f?"":f||y,i+=y;break;case"-":"<!-"===i&&(o=c),i+=y;break;case" ":case"\n":if("<"===i){o=a,l+="< ",i="";break}i+=y;break;default:i+=y}else if(o===c)switch(y){case">":"--"==i.slice(-2)&&(o=a),i="";break;default:i+=y}}return t.state=o,t.tag_buffer=i,t.depth=s,t.in_quote_char=f,l}function h(e){var t=f.exec(e);return t?t[1].toLowerCase():null}l.init_streaming_mode=function(e,t){var n=p(e=e||[],t=t||"");return function(e){return d(e||"",n)}},void 0===(r=function(){return l}.call(t,n,t,e))||(e.exports=r)}()},306:function(e,t,n){(function(t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),f=Object.prototype.toString,l=Math.max,p=Math.min,d=function(){return s.Date.now()};function h(e,t,n){var r,o,i,a,u,c,s=0,f=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=r,i=o;return r=o=void 0,s=t,a=e.apply(i,n)}function g(e){return s=e,u=setTimeout(_,t),f?m(e):a}function w(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-s>=i}function _(){var e=d();if(w(e))return O(e);u=setTimeout(_,function(e){var n=t-(e-c);return h?p(n,i-(e-s)):n}(e))}function O(e){return u=void 0,b&&r?m(e):(r=o=void 0,a)}function E(){var e=d(),n=w(e);if(r=arguments,o=this,c=e,n){if(void 0===u)return g(c);if(h)return u=setTimeout(_,t),m(c)}return void 0===u&&(u=setTimeout(_,t)),a}return t=v(t)||0,y(n)&&(f=!!n.leading,i=(h="maxWait"in n)?l(v(n.maxWait)||0,t):i,b="trailing"in n?!!n.trailing:b),E.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},E.flush=function(){return void 0===u?a:O(d())},E}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var u=o.test(e);return u||i.test(e)?a(e.slice(2),u?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return y(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),h(e,t,{leading:r,maxWait:t,trailing:o})}}).call(this,n(13))},311:function(e,t,n){"use strict";n.r(t);var r=n(9),o=n.n(r),i=n(3),a=n.n(i),u=n(80),c=n(302),s=n(303),f=n(55),l=n(183),p=function(e){if(localStorage.getItem("dchat")){var t=JSON.parse(localStorage.getItem("dchat"));e.dispatch(Object(f.a)(t))}else var n,r=e.subscribe((function(){var t;if(n!==(n=null===(t=e.getState().clients[0])||void 0===t?void 0:t.addr)){var o=e.getState().clients[0];localStorage.setItem("dchat",JSON.stringify(o)),r()}}))},d=n(304),h=n.n(d),y=n(32),v=n.n(y),b=n(7),m=n.n(b),g=n(15),w=n(174);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=Object(u.combineReducers)({login:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOGIN":e=n.payload.credentials;break;case"LOGIN_STATUS":e=n.error?{error:n.error}:n.payload;break;case"CONNECTED":e=O(O({},t),{},{connected:!0});break;case"LOGOUT":e={};break;default:e=t}return e},clients:w.b,chatSettings:function(){var e,t,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,a=null===(e=i.payload)||void 0===e?void 0:e.topic;switch(i.type){case"chat/REMOVE":n=O(O({},o),{},m()({},a,O(O({},o[a]),{},{unread:[],hidden:!0}))),g.a.chatSettings=n;break;case"chat/RECEIVE_MESSAGE":n=O(O({},o),{},m()({},a,O(O({},o[a]),{},{receivedAt:Date.now(),hidden:!1}))),g.a.chatSettings=n;break;case"chat/MARK_UNREAD":r=(null===(t=o[a])||void 0===t?void 0:t.unread)||[],n=O(O({},o),{},m()({},a,O(O({name:a},o[a]),{},{unread:[].concat(v()(r),[i.payload.message.id])}))),g.a.chatSettings=n;break;case"chat/MARK_READ":n=O(O({},o),{},m()({},a,O(O({},o[a]),{},{unread:[]}))),g.a.chatSettings=n;break;case"chat/CREATE_CHAT":n=O(O({},o),{},m()({},a,O(O({name:a,unread:[],subscribers:[],subscribersMeta:[],receivedAt:1},o[a]),{},{hidden:!1}))),g.a.chatSettings=n;break;case"chat/SET_SUBSCRIBERS":n=O(O({},o),{},m()({},a,O(O({},o[a]),{},{subscribers:i.payload.subscribers})));break;case"chat/SET_SUBSCRIPTION_INFOS":n=O(O({},o),{},m()({},a,O(O({unread:[],subscribers:[]},o[a]),{},{subscribersMeta:i.payload.data})));break;case"chat/SET_CHAT_MUTE":n=O(O({},o),{},m()({},a,O(O({},o[a]),{},{muted:i.payload.muted}))),g.a.chatSettings=n;break;default:n=o}return n},messageEvent:function(e,t){var n={};switch(t.type){case"chat/MODIFY_MESSAGE":n={topic:t.payload.topic,message:t.payload.message,type:"modify"};break;case"chat/RECEIVE_MESSAGE":n={topic:t.payload.topic,message:t.payload.message,type:"new"};break;case"chat/RECEIVE_REACTION":n={topic:t.payload.topic,reaction:t.payload.message,type:"new"};break;default:n={}}return n},globalSettings:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{muted:[]},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"settings/TOGGLE_USER_MUTE":e=t.muted.includes(n.payload.addr)?O(O({},t),{},{muted:t.muted.filter((function(e){return e!==n.payload.addr}))}):O(O({},t),{},{muted:[].concat(v()(t.muted),[n.payload.addr])}),g.a.globalSettings=e;break;default:e=t}return e},contactEvent:function(e,t){var n;switch(t.type){case"contacts/UPDATE_CONTACT":n=t.payload.contact;break;default:n={}}return n},navigation:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mostRecentPage:"/"},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"ui/NAVIGATED":e=O(O({},t),{},{mostRecentPage:n.payload.to});break;default:e=t}return e},activeTopics:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,o=null===(e=r.payload)||void 0===e?void 0:e.topic;switch(r.type){case"chat/CREATE_CHAT":(t=new Set(n)).add(o),t=Array.from(t);break;case"ui/REMOVE_ACTIVE_TOPIC":case"chat/REMOVE":t=n.filter((function(e){return e!==o}));break;default:t=n}return t}}),S=n(10),A=n(2),k=n(116),x=n.n(k);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){return function(t,n){var r;if(null===(r=e.meta)||void 0===r||!r.WebWorker){var o,i,a="LOGIN_ALIAS"===e.type&&(null===(o=n().clients.find((function(t){return t.wallet.Address===e.payload.address})))||void 0===o?void 0:o.wallet);switch(t(P(P({},e),{},{payload:P({wallet:a},e.payload),meta:P(P({},e.meta),{},{WebWorker:!0})})),e.type){case"LOGOUT_ALIAS":localStorage.clear();break;case"LOGIN_ALIAS":(i=e.payload.credentials).rememberMe&&x.a.encrypt("d-chat!!!",i).then((function(e){return localStorage.setItem("credentials",JSON.stringify(e))}))}}}},I={PUBLISH_MESSAGE_ALIAS:T,LOGIN_ALIAS:T,"chat/GET_SUBSCRIBERS_ALIAS":T,LOGOUT_ALIAS:T,"nkn/GET_BALANCE_ALIAS":T,"nkn/NEW_TRANSACTION_ALIAS":T,SUBSCRIBE_TO_CHAT_ALIAS:T,SEND_PRIVATE_MESSAGE_ALIAS:T,"chat/MAYBE_OFFER_SUBSCRIBE_ALIAS":T,"chat/FETCH_SUBSCRIPTION_INFOS_ALIAS":T,"chat/UNSUBSCRIBE_ALIAS":T,"chat/ACCEPT_TO_CHATROOM_ALIAS":T,"chat/REMOVE_ACCEPT_TO_CHATROOM_ALIAS":T,"contacts/REQUEST_CONTACT":T,"contacts/SEND_CONTACT_INFO":T,JOIN_CHAT_ALIAS:function(e){return function(t){var n=e.payload.topic;n&&(t(Object(S.c)(n)),Object(A.u)(n)&&t(Object(S.x)(n)))}}},C=n(305),D=n.n(C),R=n(4),N=function(e){return Object.values(e.chatSettings).reduce((function(e,t){return t.muted?e:e+((null===(n=t.unread)||void 0===n?void 0:n.length)||0);var n}),0)},M=function(e){return function(t){return function(n){var r,o,i,a,u,c=null===(r=n.payload)||void 0===r?void 0:r.message,s=null===(o=n.payload)||void 0===o?void 0:o.topic,f=e.getState(),l=(null===c||void 0===c?void 0:c.content)||"";switch(n.type){case"chat/RECEIVE_MESSAGE":null!==(i=Object(R.c)())&&void 0!==i&&i.includes(c.topic)||!function(e){return!Object(A.s)(e)&&!e.isMe&&!e.ignored}(c)||e.dispatch(Object(S.k)(c.topic,c)),u=c,Object(A.s)(u)||Object(A.r)(u)||!Object(A.v)(u)||u.ignored||function(t){var n=t.id,r=t.topic;t.isMe||e.dispatch(Object(S.t)({contentType:"receipt",topic:r,targetID:n}))}(c);break;case"chat/MARK_UNREAD":l="media"===c.contentType?Object(R.a)("Posted media."):D()(l),null!==(a=f.chatSettings[s])&&void 0!==a&&a.muted&&!c.refersToMe||(Object(R.b)({message:l,title:c.title||"".concat(Object(R.a)("D-Chat")," ").concat(Object(A.g)(c.topic),", ").concat(Object(A.d)(c.addr),":")}),Object(R.f)(N(f)+1));break;case"chat/MARK_READ":Object(R.f)(N(f)-n.payload.ids.length)}t(n)}}},B=n(56),K=n(175);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=[];function q(e){return V.apply(this,arguments)}function V(){return(V=o()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.unreceivable){e.next=11;break}if(!t.modifications){e.next=5;break}return t.isNotConfirmed||(t.modifications=U(U({},t.modifications),t.modifications._onConfirm)),delete t.modifications._onConfirm,e.abrupt("return",Object(B.d)({topic:t.topic,id:t.targetID,addr:t.addr},U({isNotConfirmed:t.isNotConfirmed},t.modifications)).then((function(e){return e&&[Object(S.l)(e)]})));case 5:if("media"===t.contentType&&(t.attachments=t.attachments.map((function(e){return Object(K.b)(e)}))),Object(B.e)(t),!L.includes(t.id)){e.next=10;break}return L=L.filter((function(e){return e!==t.id})),e.abrupt("return",[Object(S.l)(t)]);case 10:t.isNotConfirmed&&L.push(t.id);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.b)(t);case 2:return n=e.sent,e.abrupt("return",null!=n||Object(A.r)(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e){return function(t){return function(){var n=o()(a.a.mark((function n(r){var o,i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,n.t0=r.type,n.next="chat/RECEIVE_MESSAGE"===n.t0||"chat/RECEIVE_REACTION"===n.t0?4:10;break;case 4:return o=r.payload.message,n.next=7,z(o);case 7:return i=n.sent,q(o).then((function(t){return t.forEach((function(t){return e.dispatch(t)}))})),n.abrupt("break",10);case 10:i||t(r);case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},H=function(e){return function(t){return function(n){switch(n.type){case"chat/RECEIVE_MESSAGE":case"chat/RECEIVE_REACTION":e.getState().globalSettings.muted.includes(n.payload.message.addr)&&(n.payload.message.ignored=!0)}t(n)}}},W=function(e){return function(t){return function(n){var r,o=null===(r=n.payload)||void 0===r?void 0:r.message;return"chat/RECEIVE_MESSAGE"===n.type&&Object(A.s)(o.contentType)&&o.topic&&e.dispatch(Object(S.f)(o.topic)),t(n)}}},Y=n(46),J=n(59),X=function(e){return function(t){return function(){var n=o()(a.a.mark((function n(r){var o,i,u,c,s,f,l,p,d,h;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(o=r.type)||void 0===o||!o.startsWith("contacts")){n.next=42;break}i=r.payload.contact,u=i.requestType,c=r.payload.addr,s=i.addr,n.t0=o,n.next="contacts/RECEIVE_CONTACT_REQUEST"===n.t0?9:"contacts/UPDATE_CONTACT"===n.t0?29:40;break;case 9:n.t1=u,n.next="header"===n.t1?12:"full"===n.t1?21:26;break;case 12:return n.next=14,Object(Y.a)(c);case 14:if(n.t2=n.sent,n.t2){n.next=17;break}n.t2={};case 17:return d=n.t2,f=d.version,e.dispatch(Object(J.c)(s,{version:f})),n.abrupt("break",28);case 21:return n.next=23,Object(Y.b)(c);case 23:return l=n.sent,e.dispatch(Object(J.c)(s,l)),n.abrupt("break",28);case 26:return console.log("D-Chat: Some odd type came up:",r),n.abrupt("break",28);case 28:return n.abrupt("return");case 29:n.t3=u,n.next="response/header"===n.t3?32:"response/full"===n.t3?37:39;break;case 32:return n.next=34,Object(Y.a)(i.addr);case 34:return(p=n.sent)&&p.version===i.version?Object(Y.c)(p):e.dispatch(Object(J.b)(i.addr,"full")),n.abrupt("return");case 37:return Object(Y.c)(r.payload.contact),n.abrupt("break",39);case 39:return n.abrupt("break",40);case 40:n.next=43;break;case 42:"chat/RECEIVE_MESSAGE"===o&&Q((h=r.payload.message).addr).then((function(t){return t&&e.dispatch(Object(J.b)(h.addr,"header"))}));case 43:return n.abrupt("return",t(r));case 44:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},$={};function Q(e){return Z.apply(this,arguments)}function Z(){return(Z=o()(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$[t]){e.next=2;break}return e.abrupt("return",!1);case 2:return $[t]=!0,e.next=5,Object(Y.a)(t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:if(n=e.t0,(r=n.expiresAt)&&!(r>Date.now())){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee,te=new Worker("dchat-nkn-worker-injector.js"),ne=h()(te);if(A.b&&(ee=localStorage.getItem("credentials")))try{ee=JSON.parse(ee)}catch(oe){ee=void 0}var re=g.a.$loaded.then(o()(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={clients:g.a.clientsMeta,chatSettings:g.a.chatSettings,globalSettings:g.a.globalSettings},n=Object(u.createStore)(E,t,Object(c.composeWithDevTools)(Object(u.applyMiddleware)(ne,Object(l.alias)(I),H,X,G,M,W,s.a))),p(n),A.b&&ee&&x.a.decrypt("d-chat!!!",ee).then((function(e){var t=n.getState().clients.find((function(e){return e.active})),r=null===t||void 0===t?void 0:t.wallet.Address;r&&n.dispatch(Object(S.h)(e,r))})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))));t.default=re},32:function(e,t,n){var r=n(327),o=n(328),i=n(189),a=n(329);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(321)),o=n(184),i=n(185),a=c(n(322)),u=n(187);function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l={portName:o.DEFAULT_PORT_NAME,state:{},extensionId:null,serializer:i.noop,deserializer:i.noop,patchStrategy:a.default},p=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,r=n.portName,a=void 0===r?l.portName:r,c=n.state,f=void 0===c?l.state:c,p=n.extensionId,d=void 0===p?l.extensionId:p,h=n.serializer,y=void 0===h?l.serializer:h,v=n.deserializer,b=void 0===v?l.deserializer:v,m=n.patchStrategy,g=void 0===m?l.patchStrategy:m;if(s(this,e),!a)throw new Error("portName is required in options");if("function"!==typeof y)throw new Error("serializer must be a function");if("function"!==typeof b)throw new Error("deserializer must be a function");if("function"!==typeof g)throw new Error("patchStrategy must be one of the included patching strategies or a custom patching function");this.portName=a,this.readyResolved=!1,this.readyPromise=new Promise((function(e){return t.readyResolve=e})),this.browserAPI=(0,u.getBrowserAPI)(),this.extensionId=d,this.port=this.browserAPI.runtime.connect(this.extensionId,{name:a}),this.safetyHandler=this.safetyHandler.bind(this),this.browserAPI.runtime.onMessage&&(this.safetyMessage=this.browserAPI.runtime.onMessage.addListener(this.safetyHandler)),this.serializedPortListener=(0,i.withDeserializer)(b)((function(){var e;return(e=t.port.onMessage).addListener.apply(e,arguments)})),this.serializedMessageSender=(0,i.withSerializer)(y)((function(){var e;return(e=t.browserAPI.runtime).sendMessage.apply(e,arguments)}),1),this.listeners=[],this.state=f,this.patchStrategy=g,this.serializedPortListener((function(e){switch(e.type){case o.STATE_TYPE:t.replaceState(e.payload),t.readyResolved||(t.readyResolved=!0,t.readyResolve());break;case o.PATCH_STATE_TYPE:t.patchState(e.payload)}})),this.dispatch=this.dispatch.bind(this)}var t,n,a;return t=e,(n=[{key:"ready",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!==e?this.readyPromise.then(e):this.readyPromise}},{key:"subscribe",value:function(e){var t=this;return this.listeners.push(e),function(){t.listeners=t.listeners.filter((function(t){return t!==e}))}}},{key:"patchState",value:function(e){this.state=this.patchStrategy(this.state,e),this.listeners.forEach((function(e){return e()}))}},{key:"replaceState",value:function(e){this.state=e,this.listeners.forEach((function(e){return e()}))}},{key:"getState",value:function(){return this.state}},{key:"replaceReducer",value:function(){}},{key:"dispatch",value:function(e){var t=this;return new Promise((function(n,i){t.serializedMessageSender(t.extensionId,{type:o.DISPATCH_TYPE,portName:t.portName,payload:e},null,(function(e){var t=e.error,o=e.value;if(t){var a=new Error("".concat("\nLooks like there is an error in the background page. You might want to inspect your background page for more details.\n").concat(t));i((0,r.default)(a,t))}else n(o&&o.payload)}))}))}},{key:"safetyHandler",value:function(e){"storeReady"===e.action&&e.portName===this.portName&&(this.browserAPI.runtime.onMessage.removeListener(this.safetyHandler),this.readyResolved||(this.readyResolved=!0,this.readyResolve()))}}])&&f(t.prototype,n),a&&f(t,a),e}();t.default=p},321:function(e,t){var n=/^(?:0|[1-9]\d*)$/;function r(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=o.propertyIsEnumerable,c=Math.max;function s(e,t){var n=h(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&y(e)}(e)&&i.call(e,"callee")&&(!u.call(e,"callee")||"[object Arguments]"==a.call(e))}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var c in e)!t&&!i.call(e,c)||o&&("length"==c||p(c,r))||n.push(c);return n}function f(e,t,n){var r=e[t];i.call(e,t)&&d(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function l(e){if(!v(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||o;return e===n}(e),n=[];for(var r in e)("constructor"!=r||!t&&i.call(e,r))&&n.push(r);return n}function p(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}function d(e,t){return e===t||e!==e&&t!==t}var h=Array.isArray;function y(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=v(e)?a.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var b=function(e){return t=function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,n){if(!v(n))return!1;var r=typeof t;return!!("number"==r?y(n)&&p(t,n.length):"string"==r&&t in n)&&d(n[t],e)}(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t},n=c(void 0===n?t.length-1:n,0),function(){for(var e=arguments,o=-1,i=c(e.length-n,0),a=Array(i);++o<i;)a[o]=e[n+o];o=-1;for(var u=Array(n+1);++o<n;)u[o]=e[o];return u[n]=a,r(t,this,u)};var t,n}((function(e,t){!function(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;f(n,a,void 0===u?e[a]:u)}}(t,function(e){return y(e)?s(e,!0):l(e)}(t),e)}));e.exports=b},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=Object.assign({},e);return t.forEach((function(e){var t=e.change,o=e.key,i=e.value;switch(t){case r.DIFF_STATUS_UPDATED:n[o]=i;break;case r.DIFF_STATUS_REMOVED:Reflect.deleteProperty(n,o)}})),n};var r=n(186)},323:function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},u={getState:e.getState.bind(e),dispatch:function(){return a.apply(void 0,arguments)}};return n=(n||[]).map((function(e){return e(u)})),a=o.apply(void 0,r(n))(e.dispatch),e.dispatch=a,e}},324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(184),i=n(185),a=n(187),u=(r=n(325))&&r.__esModule?r:{default:r};var c={portName:o.DEFAULT_PORT_NAME,dispatchResponder:function(e,t){Promise.resolve(e).then((function(e){t({error:null,value:e})})).catch((function(e){console.error("error dispatching result:",e),t({error:e.message,value:null})}))},serializer:i.noop,deserializer:i.noop,diffStrategy:u.default};t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,n=t.portName,r=void 0===n?c.portName:n,u=t.dispatchResponder,s=void 0===u?c.dispatchResponder:u,f=t.serializer,l=void 0===f?c.serializer:f,p=t.deserializer,d=void 0===p?c.deserializer:p,h=t.diffStrategy,y=void 0===h?c.diffStrategy:h;if(!r)throw new Error("portName is required in options");if("function"!==typeof l)throw new Error("serializer must be a function");if("function"!==typeof d)throw new Error("deserializer must be a function");if("function"!==typeof y)throw new Error("diffStrategy must be one of the included diffing strategies or a custom diff function");var v=(0,a.getBrowserAPI)(),b=function(t,n,i){if(t.type===o.DISPATCH_TYPE&&t.portName===r){var a=Object.assign({},t.payload,{_sender:n}),u=null;try{u=e.dispatch(a)}catch(c){u=Promise.reject(c.message),console.error(c)}return s(u,i),!0}},m=function(t){if(t.name===r){var n=(0,i.withSerializer)(l)((function(){return t.postMessage.apply(t,arguments)})),a=e.getState(),u=e.subscribe((function(){var t=e.getState(),r=y(a,t);r.length&&(a=t,n({type:o.PATCH_STATE_TYPE,payload:r}))}));t.onDisconnect.addListener(u),n({type:o.STATE_TYPE,payload:a})}},g=(0,i.withDeserializer)(d),w=function(e){return e.type===o.DISPATCH_TYPE&&e.portName===r};g((function(){var e;return(e=v.runtime.onMessage).addListener.apply(e,arguments)}))(b,w),v.runtime.onMessageExternal?g((function(){var e;return(e=v.runtime.onMessageExternal).addListener.apply(e,arguments)}))(b,w):console.warn("runtime.onMessageExternal is not supported"),v.runtime.onConnect.addListener(m),v.runtime.onConnectExternal?v.runtime.onConnectExternal.addListener(m):console.warn("runtime.onConnectExternal is not supported"),v.tabs.query({},(function(e){var t=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;v.tabs.sendMessage(u.id,{action:"storeReady",portName:r},(function(){chrome.runtime.lastError}))}}catch(c){n=!0,o=c}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}}))}},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[];return Object.keys(t).forEach((function(o){e[o]!==t[o]&&n.push({key:o,value:t[o],change:r.DIFF_STATUS_UPDATED})})),Object.keys(e).forEach((function(e){t.hasOwnProperty(e)||n.push({key:e,change:r.DIFF_STATUS_REMOVED})})),n};var r=n(186)},326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){return function(){return function(t){return function(n){var r=e[n.type];return t(r?r(n):n)}}}}},327:function(e,t,n){var r=n(188);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},328:function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},329:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},4:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return v}));var r=n(9),o=n.n(r),i=n(3),a=n.n(i),u=n(301),c=n(306),s=n.n(c),f=n(15);function l(e){return e}var p=function(){},d=s()((function(e){if(f.a.audioNotifications&&Object(u.a)(),f.a.notifications&&e.message)return new Notification(e.title||"D-Chat",{body:e.message||"",icon:"/img/NKN_DCHAT-128-128-border16.png"})}),250,{trailing:!1}),h=function(){return""},y=function(){},v=function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Notification){e.next=2;break}throw new Error("No Notifications");case 2:return e.next=4,Notification.requestPermission();case 4:if("granted"!==e.sent){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},46:function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return k}));var r=n(7),o=n.n(r),i=n(34),a=n.n(i),u=n(9),c=n.n(u),s=n(3),f=n.n(s),l=n(81),p=n.n(l),d=n(20),h=n(117),y=n.n(h),v=n(118),b=n.n(v),m=["addr","content"],g=["avatar"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){return E.apply(this,arguments)}function E(){return(E=c()(f.a.mark((function e(t){var n,r,o,i,u,c,s,l,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.addr){e.next=2;break}return e.abrupt("return");case 2:return n=t.addr,r=t.content,o=a()(t,m),u=(i=r||{}).avatar,c=a()(i,g),"base64"===(null===u||void 0===u?void 0:u.type)&&(u.data&&"string"===typeof u.data?(s=u.data,l=b()(s),s=s.slice(s.indexOf(",")+1),s=y()(s,l),u.data=s,u.type="blob"):(u.data=null,u.type=null)),h=_(_({},o),{},{addr:n,content:_(_({},c),{},{avatar:u}),version:t.version||p()(r||Math.random().toString()),expiresAt:Date.now()+6048e5}),e.abrupt("return",d.a.contacts.put(h));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return A.apply(this,arguments)}function A(){return(A=c()(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",d.a.contacts.get(t).catch((function(e){return console.error("D-CHAT: getContact error:",e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=c()(f.a.mark((function e(t){var n,r,o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return o=e.t0,e.next=8,j(null===o||void 0===o||null===(n=o.content)||void 0===n||null===(r=n.avatar)||void 0===r?void 0:r.data);case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1="";case 11:return i=e.t1,e.abrupt("return",_(_({},o),{},{content:_(_({},o.content),{},{avatar:{type:"base64",data:i}})}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return e?new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)})):""}},56:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return m}));var r=n(7),o=n.n(r),i=n(9),a=n.n(i),u=n(3),c=n.n(u),s=n(20);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=25;function d(e){var t=e.topic,n=e.previous,r=void 0===n?{}:n,o=e.extra,i=void 0===o?0:o,a=r.createdAt||s.b;return s.a.messages.where("[topic+createdAt]").between([t,s.c],[t,a],!1,!1).reverse().limit(p+i).sortBy("createdAt").then((function(e){return e.reverse()}))}function h(e){return y.apply(this,arguments)}function y(){return(y=a()(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.messages.get(E(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return(b=a()(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("reaction"!==t.contentType){e.next=4;break}return e.abrupt("return",w(t));case 4:return e.abrupt("return",_(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=a()(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:if(!(r=e.sent)){e.next=6;break}return t=l(l({},r),n),e.abrupt("return",s.a.messages.put(t).then((function(){return t})).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return s.a.reactions.put(e).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)}))}function _(e){return O.apply(this,arguments)}function O(){return(O=a()(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:return(n=e.sent)&&(t.createdAt=n.createdAt),e.abrupt("return",s.a.messages.put(t).then((function(){return t})).catch((function(e){return console.error("D-CHAT: HUGE RED FLAG, DB STORAGE",e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return{topic:e.topic,id:e.id,addr:e.addr}}},566:function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}))}function o(e){return s(r(e))}function i(e){var t=e.replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(t)}function a(e){return i(u(e))}function u(e){return Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("")}function c(e){var t=u(e);return btoa(t)}function s(e){var t;return t="undefined"!==typeof Uint8Array?new Uint8Array(e.length):[],Array.prototype.forEach.call(e,(function(e,n){t[n]=e.charCodeAt(0)})),t}function f(e){return s(atob(e))}e.exports={utf8ToBinaryString:r,utf8ToBuffer:o,utf8ToBase64:function(e){var t=r(e);return btoa(t)},binaryStringToUtf8:i,bufferToUtf8:a,base64ToUtf8:function(e){return i(atob(e))},bufferToBinaryString:u,bufferToBase64:c,binaryStringToBuffer:s,base64ToBuffer:f,strToUtf8Arr:o,utf8ArrToStr:a,arrToBase64:c,base64ToArr:f}},80:function(e,t,n){"use strict";n.r(t),n.d(t,"__DO_NOT_USE__ActionTypes",(function(){return u})),n.d(t,"applyMiddleware",(function(){return h})),n.d(t,"bindActionCreators",(function(){return p})),n.d(t,"combineReducers",(function(){return f})),n.d(t,"compose",(function(){return d})),n.d(t,"createStore",(function(){return s}));var r=n(176);function o(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var i="function"===typeof Symbol&&Symbol.observable||"@@observable",a=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+a(),REPLACE:"@@redux/REPLACE"+a(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+a()}};function c(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(o(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(o(1));return n(s)(e,t)}if("function"!==typeof e)throw new Error(o(2));var a=e,f=t,l=[],p=l,d=!1;function h(){p===l&&(p=l.slice())}function y(){if(d)throw new Error(o(3));return f}function v(e){if("function"!==typeof e)throw new Error(o(4));if(d)throw new Error(o(5));var t=!0;return h(),p.push(e),function(){if(t){if(d)throw new Error(o(6));t=!1,h();var n=p.indexOf(e);p.splice(n,1),l=null}}}function b(e){if(!c(e))throw new Error(o(7));if("undefined"===typeof e.type)throw new Error(o(8));if(d)throw new Error(o(9));try{d=!0,f=a(f,e)}finally{d=!1}for(var t=l=p,n=0;n<t.length;n++){(0,t[n])()}return e}function m(e){if("function"!==typeof e)throw new Error(o(10));a=e,b({type:u.REPLACE})}function g(){var e,t=v;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(o(11));function n(){e.next&&e.next(y())}return n(),{unsubscribe:t(n)}}})[i]=function(){return this},e}return b({type:u.INIT}),(r={dispatch:b,subscribe:v,getState:y,replaceReducer:m})[i]=g,r}function f(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"===typeof e[i]&&(n[i]=e[i])}var a,c=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:u.INIT}))throw new Error(o(12));if("undefined"===typeof n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error(o(13))}))}(n)}catch(s){a=s}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,i={},u=0;u<c.length;u++){var s=c[u],f=n[s],l=e[s],p=f(l,t);if("undefined"===typeof p){t&&t.type;throw new Error(o(14))}i[s]=p,r=r||p!==l}return(r=r||c.length!==Object.keys(e).length)?i:e}}function l(e,t){return function(){return t(e.apply(this,arguments))}}function p(e,t){if("function"===typeof e)return l(e,t);if("object"!==typeof e||null===e)throw new Error(o(16));var n={};for(var r in e){var i=e[r];"function"===typeof i&&(n[r]=l(i,t))}return n}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error(o(15))},a={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},u=t.map((function(e){return e(a)}));return i=d.apply(void 0,u)(n.dispatch),Object(r.a)(Object(r.a)({},n),{},{dispatch:i})}}}}});